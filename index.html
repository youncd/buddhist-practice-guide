<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üßò‚Äç‚ôÄÔ∏è Î≤ïÎ¨∏ Í≤åÏûÑ ÏûêÎèô ÏÉùÏÑ±Í∏∞</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(-45deg, #667eea, #764ba2, #667eea, #764ba2);
            background-size: 400% 400%;
            animation: gradientFlow 15s ease infinite;
            min-height: 100vh;
            color: #333;
        }

        @keyframes gradientFlow {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            backdrop-filter: blur(10px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            background: linear-gradient(45deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .main-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        .panel {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            backdrop-filter: blur(10px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        }

        .panel h2 {
            color: #667eea;
            margin-bottom: 20px;
            font-size: 1.5em;
        }

        .upload-area {
            border: 3px dashed #667eea;
            border-radius: 15px;
            padding: 40px;
            text-align: center;
            margin-bottom: 20px;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
            min-height: 200px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .upload-area:hover {
            border-color: #764ba2;
            background: rgba(102, 126, 234, 0.05);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.2);
        }

        .upload-area.dragover {
            border-color: #764ba2;
            background: rgba(102, 126, 234, 0.15);
            transform: scale(1.02);
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.3);
        }

        .upload-area.dragover::before {
            content: 'üì• ÌååÏùºÏùÑ ÎÜìÏïÑÏ£ºÏÑ∏Ïöî!';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(102, 126, 234, 0.9);
            color: white;
            padding: 15px 30px;
            border-radius: 25px;
            font-weight: bold;
            font-size: 1.2em;
            z-index: 1;
            animation: bounce 0.5s ease infinite alternate;
        }

        @keyframes bounce {
            from { transform: translate(-50%, -50%) scale(1); }
            to { transform: translate(-50%, -50%) scale(1.1); }
        }

        .dharma-input {
            width: 100%;
            height: 200px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            padding: 15px;
            font-size: 14px;
            line-height: 1.6;
            resize: vertical;
            transition: border-color 0.3s ease;
        }

        .dharma-input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .options-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .option-card {
            background: linear-gradient(135deg, #f8f9ff, #e8ecff);
            border: 2px solid #e0e4ff;
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .option-card:hover {
            border-color: #667eea;
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.2);
        }

        .option-card.selected {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border-color: #667eea;
        }

        .btn {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            font-size: 1.1em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.3);
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 40px rgba(102, 126, 234, 0.4);
        }

        .btn:active {
            transform: translateY(-1px);
        }

        .btn-large {
            width: 100%;
            padding: 20px;
            font-size: 1.3em;
            margin: 20px 0;
        }

        .progress-container {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            backdrop-filter: blur(10px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            display: none;
        }

        .progress-bar {
            width: 100%;
            height: 20px;
            background: #f0f0f0;
            border-radius: 10px;
            overflow: hidden;
            margin: 20px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            width: 0%;
            transition: width 0.5s ease;
            border-radius: 10px;
        }

        .result-container {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            backdrop-filter: blur(10px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            display: none;
        }

        .preview-frame {
            width: 100%;
            height: 500px;
            border: none;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            margin: 20px 0;
        }

        .code-output {
            background: #1e1e1e;
            color: #f8f8f2;
            border-radius: 10px;
            padding: 20px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            max-height: 300px;
            overflow-y: auto;
            margin: 20px 0;
            white-space: pre-wrap;
        }

        .download-buttons {
            display: flex;
            gap: 15px;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .analysis-result {
            background: linear-gradient(135deg, #e8f5e8, #f0f8ff);
            border-left: 5px solid #4caf50;
            border-radius: 10px;
            padding: 20px;
            margin: 15px 0;
        }

        .detected-elements {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin: 15px 0;
        }

        .element-tag {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.9em;
            font-weight: bold;
        }

        .tips {
            background: linear-gradient(135deg, #fff3cd, #ffeaa7);
            border-left: 5px solid #ffc107;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }

        .architecture-diagram {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 30px;
            margin: 20px 0;
            backdrop-filter: blur(10px);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
        }

        .structure-tree {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 20px 0;
        }

        .tree-node {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 15px 25px;
            border-radius: 25px;
            margin: 10px;
            text-align: center;
            position: relative;
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.3);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .tree-node:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(102, 126, 234, 0.4);
        }

        .tree-node.root {
            font-size: 1.2em;
            font-weight: bold;
            background: linear-gradient(135deg, #ff6b6b, #feca57);
        }

        .tree-level {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 15px;
            margin: 20px 0;
        }

        .tree-connector {
            width: 2px;
            height: 30px;
            background: linear-gradient(to bottom, #667eea, #764ba2);
            margin: 0 auto;
        }

        .tree-branch {
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 10px 0;
        }

        .tree-branch::before {
            content: '';
            flex: 1;
            height: 2px;
            background: linear-gradient(to right, #667eea, #764ba2);
            margin: 0 10px;
        }

        .tree-branch::after {
            content: '';
            flex: 1;
            height: 2px;
            background: linear-gradient(to left, #667eea, #764ba2);
            margin: 0 10px;
        }

        .flow-diagram {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 30px 0;
            flex-wrap: wrap;
            gap: 20px;
        }

        .flow-step {
            flex: 1;
            min-width: 200px;
            background: linear-gradient(135deg, #f093fb, #f5576c);
            color: white;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            position: relative;
            box-shadow: 0 10px 25px rgba(240, 147, 251, 0.3);
        }

        .flow-step::after {
            content: '‚Üí';
            position: absolute;
            right: -15px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 1.5em;
            color: #667eea;
            font-weight: bold;
        }

        .flow-step:last-child::after {
            display: none;
        }

        .practice-elements {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .practice-card {
            background: linear-gradient(135deg, #a8edea, #fed6e3);
            color: #333;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 10px 25px rgba(168, 237, 234, 0.3);
            transition: transform 0.3s ease;
        }

        .practice-card:hover {
            transform: scale(1.05);
        }

        .science-connections {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .science-card {
            background: linear-gradient(135deg, #ffeaa7, #fab1a0);
            color: #333;
            padding: 20px;
            border-radius: 15px;
            border-left: 5px solid #e17055;
        }

        .keyword-cloud {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 10px;
            margin: 20px 0;
            padding: 20px;
            background: linear-gradient(135deg, #e8f5ff, #f0f8ff);
            border-radius: 15px;
        }

        .keyword-tag {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.9em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .keyword-tag:hover {
            transform: scale(1.1);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .timeline {
            position: relative;
            margin: 30px 0;
            padding: 0 20px;
        }

        .timeline::before {
            content: '';
            position: absolute;
            left: 50%;
            top: 0;
            bottom: 0;
            width: 4px;
            background: linear-gradient(to bottom, #667eea, #764ba2);
            transform: translateX(-50%);
        }

        .timeline-item {
            position: relative;
            margin: 30px 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .timeline-item:nth-child(odd) .timeline-content {
            margin-right: 55%;
        }

        .timeline-item:nth-child(even) .timeline-content {
            margin-left: 55%;
        }

        .timeline-content {
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            position: relative;
        }

        .timeline-marker {
            position: absolute;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
            width: 20px;
            height: 20px;
            background: #ffeb3b;
            border-radius: 50%;
            border: 4px solid white;
            box-shadow: 0 5px 15px rgba(255, 235, 59, 0.5);
            z-index: 1;
        }

        .loading-spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
            margin-right: 10px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: linear-gradient(135deg, #4caf50, #45a049);
            color: white;
            padding: 15px 25px;
            border-radius: 10px;
            box-shadow: 0 10px 30px rgba(76, 175, 80, 0.3);
            transform: translateX(100%);
            transition: transform 0.3s ease;
            z-index: 1000;
        }

        .notification.show {
            transform: translateX(0);
        }

        .pdf-only {
            display: none;
        }

        /* PDF Ïù∏ÏáÑÏö© Ïä§ÌÉÄÏùº */
        @media print {
            body {
                background: white !important;
                color: black !important;
            }
            
            .container {
                max-width: none !important;
                padding: 0 !important;
            }
            
            .header, .main-grid, .progress-container, .result-container .download-buttons,
            .tips, .notification {
                display: none !important;
            }
            
            .architecture-diagram {
                background: white !important;
                box-shadow: none !important;
                border: 1px solid #ddd !important;
                page-break-inside: avoid;
                margin: 20px 0 !important;
            }
            
            .tree-node, .flow-step, .practice-card, .science-card {
                background: #f8f9fa !important;
                color: black !important;
                border: 1px solid #ddd !important;
                box-shadow: none !important;
            }
            
            .keyword-tag {
                background: #e9ecef !important;
                color: black !important;
            }
            
            .timeline-content {
                background: white !important;
                border: 1px solid #ddd !important;
            }
            
            h3, h4 {
                color: black !important;
            }
            
            .pdf-title {
                display: block !important;
                text-align: center;
                font-size: 24px;
                font-weight: bold;
                margin-bottom: 30px;
                padding-bottom: 10px;
                border-bottom: 2px solid black;
            }
            
            .pdf-date {
                display: block !important;
                text-align: right;
                font-size: 12px;
                margin-bottom: 20px;
            }
        }

        @media (max-width: 768px) {
            .main-grid {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 2em;
            }
            
            .download-buttons {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
            }
            
            .flow-diagram {
                flex-direction: column;
            }
            
            .flow-step::after {
                content: '‚Üì';
                right: 50%;
                bottom: -15px;
                top: auto;
                transform: translateX(50%);
            }
            
            .timeline::before {
                left: 20px;
            }
            
            .timeline-item:nth-child(odd) .timeline-content,
            .timeline-item:nth-child(even) .timeline-content {
                margin-left: 50px;
                margin-right: 0;
            }
            
            .timeline-marker {
                left: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Ìó§Îçî -->
        <header class="header">
            <h1>üßò‚Äç‚ôÄÔ∏è Î≤ïÎ¨∏ Í≤åÏûÑ ÏûêÎèô ÏÉùÏÑ±Í∏∞</h1>
            <p style="font-size: 1.1em; opacity: 0.8; margin-top: 10px;">
                Î∂àÍµê Î≤ïÎ¨∏ÏùÑ ÏóÖÎ°úÎìúÌïòÎ©¥ ÏûêÎèôÏúºÎ°ú ÎßûÏ∂§Ìòï ÎßàÏùåÏ±ôÍπÄ ÏàòÌñâ Í≤åÏûÑÏùÑ ÏÉùÏÑ±Ìï©ÎãàÎã§
            </p>
        </header>

        <!-- Î©îÏù∏ ÏûÖÎ†• ÏòÅÏó≠ -->
        <div class="main-grid">
            <!-- Î≤ïÎ¨∏ ÏûÖÎ†• Ìå®ÎÑê -->
            <div class="panel">
                <h2>üìú Î≤ïÎ¨∏ ÏûÖÎ†•</h2>
                
                <!-- ÌååÏùº ÏóÖÎ°úÎìú ÏòÅÏó≠ -->
                <div class="upload-area" id="uploadArea">
                    <div style="font-size: 3em; margin-bottom: 15px;">üìÑ</div>
                    <h3>Î≤ïÎ¨∏ ÌååÏùºÏùÑ Ïó¨Í∏∞Ïóê ÎìúÎûòÍ∑∏ÌïòÏÑ∏Ïöî</h3>
                    <p style="margin: 10px 0; opacity: 0.7;">ÎòêÎäî ÌÅ¥Î¶≠ÌïòÏó¨ ÌååÏùº ÏÑ†ÌÉù</p>
                    <p style="font-size: 0.9em; opacity: 0.6;">ÏßÄÏõê ÌòïÏãù: PDF, TXT, DOC, DOCX</p>
                    <div style="margin-top: 15px; font-size: 0.8em; color: #666;">
                        ‚ú® ÎìúÎûòÍ∑∏ Ïï§ ÎìúÎ°≠ÏúºÎ°ú Í∞ÑÌé∏ÌïòÍ≤å ÏóÖÎ°úÎìúÌïòÏÑ∏Ïöî!
                    </div>
                    <input type="file" id="fileInput" style="display: none;" accept=".pdf,.txt,.doc,.docx">
                </div>

                <!-- ÌÖçÏä§Ìä∏ ÏßÅÏ†ë ÏûÖÎ†• -->
                <div style="text-align: center; margin: 20px 0;">
                    <strong>ÎòêÎäî</strong>
                </div>
                
                <textarea class="dharma-input" id="dharmaText" placeholder="Î≤ïÎ¨∏ ÎÇ¥Ïö©ÏùÑ ÏßÅÏ†ë Î∂ôÏó¨ÎÑ£Ïñ¥Ï£ºÏÑ∏Ïöî...

üìù ÏòàÏãú 1 - ÌåîÏ†ïÎèÑ Î≤ïÎ¨∏:
Î∂ÄÏ≤òÎãòÍªòÏÑú ÎßêÏîÄÌïòÏã† ÌåîÏ†ïÎèÑÎäî Íπ®Îã¨ÏùåÏóê Ïù¥Î•¥Îäî Ïó¨Îçü Í∞ÄÏßÄ Î∞îÎ•∏ Í∏∏ÏûÖÎãàÎã§.
Ï†ïÍ≤¨(Ê≠£Ë¶ã): Ïò¨Î∞îÎ•∏ Í≤¨Ìï¥Î•º Í∞ñÎäî Í≤É
Ï†ïÏÇ¨Ïú†(Ê≠£ÊÄùÊÉü): Ïò¨Î∞îÎ•∏ ÏÉùÍ∞ÅÏùÑ ÌïòÎäî Í≤É  
Ï†ïÏñ¥(Ê≠£Ë™û): Ïò¨Î∞îÎ•∏ ÎßêÏùÑ ÌïòÎäî Í≤É
Ï†ïÏóÖ(Ê≠£Ê•≠): Ïò¨Î∞îÎ•∏ ÌñâÎèôÏùÑ ÌïòÎäî Í≤É
Ï†ïÎ™Ö(Ê≠£ÂëΩ): Ïò¨Î∞îÎ•∏ ÏÉùÌôúÏùÑ ÌïòÎäî Í≤É
Ï†ïÏ†ïÏßÑ(Ê≠£Á≤æÈÄ≤): Ïò¨Î∞îÎ•∏ ÎÖ∏Î†•ÏùÑ ÌïòÎäî Í≤É
Ï†ïÎÖê(Ê≠£Âøµ): Ïò¨Î∞îÎ•∏ ÎßàÏùåÏ±ôÍπÄÏùÑ ÌïòÎäî Í≤É
Ï†ïÏ†ï(Ê≠£ÂÆö): Ïò¨Î∞îÎ•∏ ÏßëÏ§ëÏùÑ ÌïòÎäî Í≤É

üìù ÏòàÏãú 2 - ÏÇ¨ÏÑ±Ï†ú Î≤ïÎ¨∏:
ÏÇ¨ÏÑ±Ï†úÎäî Î∂ÄÏ≤òÎãòÏù¥ Íπ®Îã¨ÏúºÏã† ÎÑ§ Í∞ÄÏßÄ ÏÑ±Ïä§Îü¨Ïö¥ ÏßÑÎ¶¨ÏûÖÎãàÎã§.
Í≥†ÏÑ±Ï†ú: Í¥¥Î°úÏõÄÏù¥ ÏûàÎã§Îäî ÏßÑÎ¶¨
ÏßëÏÑ±Ï†ú: Í¥¥Î°úÏõÄÏùò ÏõêÏù∏Ïù¥ ÏûàÎã§Îäî ÏßÑÎ¶¨  
Î©∏ÏÑ±Ï†ú: Í¥¥Î°úÏõÄÏù¥ ÏÇ¨ÎùºÏßà Ïàò ÏûàÎã§Îäî ÏßÑÎ¶¨
ÎèÑÏÑ±Ï†ú: Í¥¥Î°úÏõÄÏùÑ ÏóÜÏï†Îäî Î∞©Î≤ïÏù¥ ÏûàÎã§Îäî ÏßÑÎ¶¨

üéØ ÏúÑ ÏòàÏãú Ï§ë ÌïòÎÇòÎ•º Î≥µÏÇ¨Ìï¥ÏÑú ÌÖåÏä§Ìä∏Ìï¥Î≥¥ÏÑ∏Ïöî!"></textarea>
            </div>

            <!-- ÏÑ§Ï†ï Ìå®ÎÑê -->
            <div class="panel">
                <h2>üé® Í≤åÏûÑ ÏÑ§Ï†ï</h2>
                
                <h3 style="margin: 20px 0 10px 0;">Í≤åÏûÑ Ïä§ÌÉÄÏùº</h3>
                <div class="options-grid">
                    <div class="option-card selected" data-style="modern">
                        <div style="font-size: 2em;">üåü</div>
                        <div>ÌòÑÎåÄÏ†Å</div>
                    </div>
                    <div class="option-card" data-style="traditional">
                        <div style="font-size: 2em;">üèÆ</div>
                        <div>Ï†ÑÌÜµÏ†Å</div>
                    </div>
                    <div class="option-card" data-style="minimal">
                        <div style="font-size: 2em;">‚ö™</div>
                        <div>ÎØ∏ÎãàÎ©Ä</div>
                    </div>
                </div>

                <h3 style="margin: 20px 0 10px 0;">ÏÉâÏÉÅ ÌÖåÎßà</h3>
                <div class="options-grid">
                    <div class="option-card selected" data-color="blue">
                        <div style="background: linear-gradient(135deg, #667eea, #764ba2); width: 30px; height: 30px; border-radius: 50%; margin: 0 auto 5px;"></div>
                        <div>ÌååÎûÄÏÉâ</div>
                    </div>
                    <div class="option-card" data-color="green">
                        <div style="background: linear-gradient(135deg, #56ab2f, #a8e6cf); width: 30px; height: 30px; border-radius: 50%; margin: 0 auto 5px;"></div>
                        <div>Ï¥àÎ°ùÏÉâ</div>
                    </div>
                    <div class="option-card" data-color="purple">
                        <div style="background: linear-gradient(135deg, #8360c3, #2ebf91); width: 30px; height: 30px; border-radius: 50%; margin: 0 auto 5px;"></div>
                        <div>Î≥¥ÎùºÏÉâ</div>
                    </div>
                    <div class="option-card" data-color="orange">
                        <div style="background: linear-gradient(135deg, #f093fb, #f5576c); width: 30px; height: 30px; border-radius: 50%; margin: 0 auto 5px;"></div>
                        <div>Ï£ºÌô©ÏÉâ</div>
                    </div>
                </div>

                <h3 style="margin: 20px 0 10px 0;">Ïï†ÎãàÎ©îÏù¥ÏÖò</h3>
                <div class="options-grid">
                    <div class="option-card selected" data-animation="smooth">
                        <div style="font-size: 2em;">‚ú®</div>
                        <div>Î∂ÄÎìúÎü¨ÏõÄ</div>
                    </div>
                    <div class="option-card" data-animation="dynamic">
                        <div style="font-size: 2em;">üé¨</div>
                        <div>Ïó≠ÎèôÏ†Å</div>
                    </div>
                    <div class="option-card" data-animation="minimal">
                        <div style="font-size: 2em;">‚ûñ</div>
                        <div>ÏµúÏÜåÌïú</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Í≤åÏûÑ ÏÉùÏÑ± Î≤ÑÌäº -->
        <div style="text-align: center;">
            <button class="btn btn-large" id="generateBtn">
                üöÄ ÎßàÏùåÏ±ôÍπÄ Í≤åÏûÑ ÏûêÎèô ÏÉùÏÑ±ÌïòÍ∏∞
            </button>
        </div>

        <!-- ÏßÑÌñâÏÉÅÌô© -->
        <div class="progress-container" id="progressContainer">
            <h2>üîÑ Í≤åÏûÑ ÏÉùÏÑ± Ï§ë...</h2>
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            <div id="progressText">Î≤ïÎ¨∏ Î∂ÑÏÑù Ï§ë...</div>
        </div>

        <!-- Í≤∞Í≥º ÏòÅÏó≠ -->
        <div class="result-container" id="resultContainer">
            <h2>üéâ Í≤åÏûÑ ÏÉùÏÑ± ÏôÑÎ£å!</h2>
            
            <div id="analysisResult"></div>
            
            <div class="download-buttons">
                <button class="btn" id="previewBtn">üëÄ ÎØ∏Î¶¨Î≥¥Í∏∞</button>
                <button class="btn" id="downloadBtn">üíæ HTML Îã§Ïö¥Î°úÎìú</button>
                <button class="btn" id="downloadPdfBtn">üìÑ ÏïÑÌÇ§ÌÖçÏ≤ò PDF Îã§Ïö¥Î°úÎìú</button>
                <button class="btn" id="copyCodeBtn">üìã ÏΩîÎìú Î≥µÏÇ¨</button>
                <button class="btn" id="newGameBtn">üîÑ ÏÉà Í≤åÏûÑ ÎßåÎì§Í∏∞</button>
            </div>

            <div id="previewArea" style="display: none;">
                <h3>üì± Í≤åÏûÑ ÎØ∏Î¶¨Î≥¥Í∏∞</h3>
                <iframe class="preview-frame" id="previewFrame"></iframe>
            </div>

            <div id="codeArea" style="display: none;">
                <h3>üíª ÏÉùÏÑ±Îêú HTML ÏΩîÎìú</h3>
                <div class="code-output" id="codeOutput"></div>
            </div>
        </div>

        <!-- ÏÇ¨Ïö© ÌåÅ -->
        <div class="tips">
            <h3>üí° ÏÇ¨Ïö© ÌåÅ</h3>
            <ul style="margin: 10px 0; padding-left: 20px;">
                <li>ÌåîÏ†ïÎèÑ, ÏÇ¨ÏÑ±Ï†ú, ÏÇºÌïô, ÏÇ¨ÎÖêÏ≤ò Îì± Íµ¨Ï°∞Í∞Ä Î™ÖÌôïÌïú Î≤ïÎ¨∏ÏùºÏàòÎ°ù Îçî Ï¢ãÏùÄ Í≤åÏûÑÏù¥ ÏÉùÏÑ±Îê©ÎãàÎã§</li>
                <li>Î≤ïÎ¨∏ ÌÖçÏä§Ìä∏Í∞Ä Í∏∏Í≥† ÏûêÏÑ∏Ìï†ÏàòÎ°ù Îçî ÌíçÎ∂ÄÌïú ÏΩòÌÖêÏ∏†Í∞Ä ÏÉùÏÑ±Îê©ÎãàÎã§</li>
                <li>ÏÉùÏÑ±Îêú HTML ÌååÏùºÏùÄ GitHub PagesÏóê Î∞îÎ°ú ÏóÖÎ°úÎìúÌïòÏó¨ ÏÑúÎπÑÏä§Ìï† Ïàò ÏûàÏäµÎãàÎã§</li>
                <li>Î™®Î∞îÏùºÏóêÏÑúÎèÑ ÏôÑÎ≤ΩÌïòÍ≤å ÏûëÎèôÌïòÎäî Î∞òÏùëÌòï Í≤åÏûÑÏù¥ ÏÉùÏÑ±Îê©ÎãàÎã§</li>
            </ul>
        </div>
    </div>

    <!-- ÏïåÎ¶º -->
    <div class="notification" id="notification"></div>

    <script>
        // Ï†ÑÏó≠ Î≥ÄÏàò
        let selectedOptions = {
            style: 'modern',
            color: 'blue',
            animation: 'smooth'
        };

        let generatedHTML = '';
        let analysisData = {};

        // DOM ÏöîÏÜåÎì§
        const uploadArea = document.getElementById('uploadArea');
        const fileInput = document.getElementById('fileInput');
        const dharmaText = document.getElementById('dharmaText');
        const generateBtn = document.getElementById('generateBtn');
        const progressContainer = document.getElementById('progressContainer');
        const resultContainer = document.getElementById('resultContainer');

        // Ï¥àÍ∏∞Ìôî
        document.addEventListener('DOMContentLoaded', function() {
            setupEventListeners();
            setupFileUpload();
            setupOptionCards();
            
            // Ï†ÑÏó≠ ÎìúÎûòÍ∑∏ Ïï§ ÎìúÎ°≠ Ïù¥Î≤§Ìä∏ Î∞©ÏßÄ (ÌååÏùºÏù¥ Î∏åÎùºÏö∞Ï†ÄÏóêÏÑú Ïó¥Î¶¨Îäî Í≤É Î∞©ÏßÄ)
            ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
                document.addEventListener(eventName, function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                }, false);
            });
            
            // Ï¥àÍ∏∞ ÏïåÎ¶º
            setTimeout(() => {
                showNotification('üéâ Î≤ïÎ¨∏ Í≤åÏûÑ ÏÉùÏÑ±Í∏∞Í∞Ä Ï§ÄÎπÑÎêòÏóàÏäµÎãàÎã§! ÌååÏùºÏùÑ ÎìúÎûòÍ∑∏ÌïòÍ±∞ÎÇò ÌÖçÏä§Ìä∏Î•º ÏûÖÎ†•Ìï¥Î≥¥ÏÑ∏Ïöî.', 'info');
            }, 1000);
        });

        // Ïù¥Î≤§Ìä∏ Î¶¨Ïä§ÎÑà ÏÑ§Ï†ï
        function setupEventListeners() {
            generateBtn.addEventListener('click', generateGame);
            document.getElementById('previewBtn').addEventListener('click', showPreview);
            document.getElementById('downloadBtn').addEventListener('click', downloadHTML);
            document.getElementById('downloadPdfBtn').addEventListener('click', downloadPDF);
            document.getElementById('copyCodeBtn').addEventListener('click', copyCode);
            document.getElementById('newGameBtn').addEventListener('click', resetForm);
        }

        // ÌååÏùº ÏóÖÎ°úÎìú ÏÑ§Ï†ï
        function setupFileUpload() {
            uploadArea.addEventListener('click', () => fileInput.click());
            uploadArea.addEventListener('dragover', handleDragOver);
            uploadArea.addEventListener('drop', handleDrop);
            uploadArea.addEventListener('dragleave', handleDragLeave);
            fileInput.addEventListener('change', handleFileSelect);
        }

        function handleDragOver(e) {
            e.preventDefault();
            e.stopPropagation();
            uploadArea.classList.add('dragover');
            e.dataTransfer.dropEffect = 'copy';
        }

        function handleDragLeave(e) {
            e.preventDefault();
            e.stopPropagation();
            // Ïã§Ï†úÎ°ú ÏòÅÏó≠ÏùÑ Î≤óÏñ¥ÎÇ¨ÎäîÏßÄ ÌôïÏù∏
            if (!uploadArea.contains(e.relatedTarget)) {
                uploadArea.classList.remove('dragover');
            }
        }

        function handleDrop(e) {
            e.preventDefault();
            e.stopPropagation();
            uploadArea.classList.remove('dragover');
            
            const files = e.dataTransfer.files;
            console.log('ÎìúÎ°≠Îêú ÌååÏùº:', files.length, 'Í∞ú');
            
            if (files.length > 0) {
                const file = files[0];
                console.log('ÌååÏùº Ï†ïÎ≥¥:', {
                    name: file.name,
                    size: file.size,
                    type: file.type
                });
                
                // ÌååÏùº ÌòïÏãù Í≤ÄÏ¶ù
                const allowedTypes = [
                    'text/plain',
                    'application/pdf', 
                    'application/msword',
                    'application/vnd.openxmlformats-officedocument.wordprocessingml.document'
                ];
                
                const allowedExtensions = ['.txt', '.pdf', '.doc', '.docx'];
                const fileExtension = file.name.toLowerCase().substring(file.name.lastIndexOf('.'));
                
                if (allowedTypes.includes(file.type) || allowedExtensions.includes(fileExtension) || file.type === '') {
                    showNotification(`"${file.name}" ÌååÏùº Ï≤òÎ¶¨Î•º ÏãúÏûëÌï©ÎãàÎã§...`, 'info');
                    processFile(file);
                } else {
                    showNotification(`ÏßÄÏõêÌïòÏßÄ ÏïäÎäî ÌååÏùº ÌòïÏãùÏûÖÎãàÎã§. (${file.type})\\nÏßÄÏõê ÌòïÏãù: TXT, PDF, DOC, DOCX`, 'error');
                }
            } else {
                showNotification('ÌååÏùºÏù¥ Í∞êÏßÄÎêòÏßÄ ÏïäÏïòÏäµÎãàÎã§. Îã§Ïãú ÏãúÎèÑÌï¥Ï£ºÏÑ∏Ïöî.', 'error');
            }
        }

        function handleFileSelect(e) {
            const file = e.target.files[0];
            if (file) {
                console.log('ÏÑ†ÌÉùÎêú ÌååÏùº:', file.name);
                processFile(file);
            }
        }

        async function processFile(file) {
            try {
                showNotification('ÌååÏùºÏùÑ ÏùΩÎäî Ï§ëÏûÖÎãàÎã§...', 'info');
                let text = '';
                
                // Claude Artifact ÌôòÍ≤ΩÏóêÏÑú ÌååÏùº ÏùΩÍ∏∞
                if (window.fs && window.fs.readFile) {
                    try {
                        // Claude ArtifactÏùò fs API ÏÇ¨Ïö©
                        const uint8Array = await window.fs.readFile(file.name);
                        const decoder = new TextDecoder('utf-8');
                        text = decoder.decode(uint8Array);
                    } catch (fsError) {
                        console.log('fs API Ïã§Ìå®, FileReaderÎ°ú ÎåÄÏ≤¥:', fsError);
                        // fs API Ïã§Ìå® Ïãú ÏùºÎ∞ò FileReader ÏÇ¨Ïö©
                        text = await readFileAsText(file);
                    }
                } else {
                    // ÏùºÎ∞ò Î∏åÎùºÏö∞Ï†Ä ÌôòÍ≤ΩÏóêÏÑú FileReader ÏÇ¨Ïö©
                    text = await readFileAsText(file);
                }
                
                if (text && text.trim().length > 0) {
                    dharmaText.value = text;
                    showNotification(`ÌååÏùº "${file.name}"ÏùÑ ÏÑ±Í≥µÏ†ÅÏúºÎ°ú Î∂àÎü¨ÏôîÏäµÎãàÎã§! (${text.length}Ïûê)`, 'success');
                    
                    // ÌååÏùº ÎÇ¥Ïö© ÎØ∏Î¶¨Î≥¥Í∏∞
                    const preview = text.length > 200 ? text.substring(0, 200) + '...' : text;
                    console.log('ÌååÏùº ÎÇ¥Ïö© ÎØ∏Î¶¨Î≥¥Í∏∞:', preview);
                } else {
                    showNotification('ÌååÏùºÏù¥ ÎπÑÏñ¥ÏûàÍ±∞ÎÇò ÏùΩÏùÑ Ïàò ÏóÜÏäµÎãàÎã§.', 'error');
                }
            } catch (error) {
                console.error('ÌååÏùº ÏùΩÍ∏∞ Ïò§Î•ò:', error);
                showNotification(`ÌååÏùºÏùÑ ÏùΩÎäî Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§: ${error.message}`, 'error');
            }
        }

        function readFileAsText(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.onload = (e) => {
                    try {
                        resolve(e.target.result);
                    } catch (error) {
                        reject(error);
                    }
                };
                reader.onerror = () => reject(new Error('ÌååÏùº ÏùΩÍ∏∞ Ïã§Ìå®'));
                reader.readAsText(file, 'UTF-8');
            });
        }

        // ÏòµÏÖò Ïπ¥Îìú ÏÑ§Ï†ï
        function setupOptionCards() {
            document.querySelectorAll('.option-card').forEach(card => {
                card.addEventListener('click', function() {
                    const parent = this.parentElement;
                    parent.querySelectorAll('.option-card').forEach(c => c.classList.remove('selected'));
                    this.classList.add('selected');
                    
                    // ÏÑ†ÌÉùÎêú ÏòµÏÖò Ï†ÄÏû•
                    if (this.dataset.style) selectedOptions.style = this.dataset.style;
                    if (this.dataset.color) selectedOptions.color = this.dataset.color;
                    if (this.dataset.animation) selectedOptions.animation = this.dataset.animation;
                });
            });
        }

        // Í≤åÏûÑ ÏÉùÏÑ± Î©îÏù∏ Ìï®Ïàò
        async function generateGame() {
            const text = dharmaText.value.trim();
            if (!text) {
                showNotification('Î≤ïÎ¨∏ ÎÇ¥Ïö©ÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî!', 'error');
                return;
            }

            showProgress();
            
            try {
                // 1Îã®Í≥Ñ: Î≤ïÎ¨∏ Î∂ÑÏÑù
                updateProgress(20, 'Î≤ïÎ¨∏ ÎÇ¥Ïö© Î∂ÑÏÑù Ï§ë...');
                analysisData = analyzeDharmaText(text);
                
                await delay(1000);
                
                // 2Îã®Í≥Ñ: Í≤åÏûÑ Íµ¨Ï°∞ ÏÑ§Í≥Ñ
                updateProgress(40, 'Í≤åÏûÑ Íµ¨Ï°∞ ÏÑ§Í≥Ñ Ï§ë...');
                const gameStructure = designGameStructure(analysisData);
                
                await delay(1000);
                
                // 3Îã®Í≥Ñ: ÏΩòÌÖêÏ∏† ÏÉùÏÑ±
                updateProgress(60, 'Í≤åÏûÑ ÏΩòÌÖêÏ∏† ÏÉùÏÑ± Ï§ë...');
                const gameContent = generateGameContent(analysisData, gameStructure);
                
                await delay(1000);
                
                // 4Îã®Í≥Ñ: HTML ÏΩîÎìú ÏÉùÏÑ±
                updateProgress(80, 'HTML ÏΩîÎìú ÏÉùÏÑ± Ï§ë...');
                generatedHTML = generateHTMLCode(gameContent, selectedOptions);
                
                await delay(1000);
                
                // 5Îã®Í≥Ñ: ÏôÑÎ£å
                updateProgress(100, 'Í≤åÏûÑ ÏÉùÏÑ± ÏôÑÎ£å!');
                
                await delay(500);
                
                showResult();
                
            } catch (error) {
                showNotification('Í≤åÏûÑ ÏÉùÏÑ± Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.', 'error');
                hideProgress();
            }
        }

        // Î≤ïÎ¨∏ ÌÖçÏä§Ìä∏ Î∂ÑÏÑù
        function analyzeDharmaText(text) {
            const analysis = {
                detectedTopics: [],
                structure: null,
                elements: [],
                keyPhrases: [],
                practiceElements: []
            };

            // Ï£ºÏöî Î∂àÍµê Ï£ºÏ†ú Í∞êÏßÄ
            const topics = [
                { key: 'ÌåîÏ†ïÎèÑ', pattern: /(ÌåîÏ†ïÎèÑ|Ï†ïÍ≤¨|Ï†ïÏÇ¨Ïú†|Ï†ïÏñ¥|Ï†ïÏóÖ|Ï†ïÎ™Ö|Ï†ïÏ†ïÏßÑ|Ï†ïÎÖê|Ï†ïÏ†ï)/g, steps: 8 },
                { key: 'ÏÇ¨ÏÑ±Ï†ú', pattern: /(ÏÇ¨ÏÑ±Ï†ú|Í≥†ÏÑ±Ï†ú|ÏßëÏÑ±Ï†ú|Î©∏ÏÑ±Ï†ú|ÎèÑÏÑ±Ï†ú|Í≥†ÏßëÎ©∏ÎèÑ)/g, steps: 4 },
                { key: 'ÏÇºÌïô', pattern: /(ÏÇºÌïô|Í≥ÑÏ†ïÌòú|Í≥ÑÏú®|ÏÑ†Ï†ï|ÏßÄÌòú)/g, steps: 3 },
                { key: 'ÏÇ¨ÎÖêÏ≤ò', pattern: /(ÏÇ¨ÎÖêÏ≤ò|Ïã†ÎÖêÏ≤ò|ÏàòÎÖêÏ≤ò|Ïã¨ÎÖêÏ≤ò|Î≤ïÎÖêÏ≤ò)/g, steps: 4 },
                { key: 'Ïò§Ïò®', pattern: /(Ïò§Ïò®|ÏÉâÏàòÏÉÅÌñâÏãù|ÏÉâÏò®|ÏàòÏò®|ÏÉÅÏò®|ÌñâÏò®|ÏãùÏò®)/g, steps: 5 },
                { key: 'Ïã≠Ïù¥Ïó∞Í∏∞', pattern: /(Ïã≠Ïù¥Ïó∞Í∏∞|Ïó∞Í∏∞Î≤ï|Î¨¥Î™Ö|Ìñâ|Ïãù|Î™ÖÏÉâ|Ïú°ÏûÖ|Ï¥â|Ïàò|Ïï†|Ï∑®|Ïú†|ÏÉù|ÎÖ∏ÏÇ¨)/g, steps: 12 },
                { key: 'ÏÇ¨Î¨¥ÎüâÏã¨', pattern: /(ÏÇ¨Î¨¥ÎüâÏã¨|ÏûêÎπÑÌù¨ÏÇ¨|ÏûêÏï†|Ïó∞ÎØº|Í∏∞ÏÅ®|ÌèâÏ†ï)/g, steps: 4 }
            ];

            topics.forEach(topic => {
                const matches = text.match(topic.pattern);
                if (matches && matches.length > 2) {
                    analysis.detectedTopics.push(topic.key);
                    if (!analysis.structure) {
                        analysis.structure = { name: topic.key, steps: topic.steps };
                    }
                }
            });

            // ÏàòÌñâ ÏöîÏÜå Ï∂îÏ∂ú
            const practicePatterns = [
                { name: 'Î™ÖÏÉÅ', pattern: /(Î™ÖÏÉÅ|Ï¢åÏÑ†|ÏÑ†Ï†ï|ÏÇ¨ÎßàÌÉÄ|ÏúÑÎπ†ÏÇ¨ÎÇò)/g },
                { name: 'Í¥ÄÏ∞∞', pattern: /(Í¥ÄÏ∞∞|ÏïåÏïÑÏ∞®Î¶º|ÎßàÏùåÏ±ôÍπÄ|ÏÇ¨Îù†)/g },
                { name: 'Ìò∏Ìù°', pattern: /(Ìò∏Ìù°|Îì§Ïà®|ÎÇ†Ïà®|Ïà®|ÏïÑÎÇòÎπ†ÎÇò)/g },
                { name: 'Í±∑Í∏∞', pattern: /(Í±∑Í∏∞|ÌñâÏÑ†|Î≥¥Ìñâ)/g },
                { name: 'ÏûêÎπÑ', pattern: /(ÏûêÎπÑ|ÏûêÏï†|Ïó∞ÎØº|Î©îÎî∞)/g }
            ];

            practicePatterns.forEach(pattern => {
                if (text.match(pattern.pattern)) {
                    analysis.practiceElements.push(pattern.name);
                }
            });

            // ÌïµÏã¨ Î¨∏Íµ¨ Ï∂îÏ∂ú (Í∞ÑÎã®Ìïú Î∞©Ïãù)
            const sentences = text.split(/[.!?„ÄÇ]/);
            analysis.keyPhrases = sentences
                .filter(s => s.length > 10 && s.length < 100)
                .slice(0, 10)
                .map(s => s.trim());

            // Í∏∞Î≥∏ Íµ¨Ï°∞ ÏÑ§Ï†ï
            if (!analysis.structure) {
                analysis.structure = { name: 'ÎßàÏùåÏ±ôÍπÄ ÏàòÌñâ', steps: 6 };
            }

            return analysis;
        }

        // Í≤åÏûÑ Íµ¨Ï°∞ ÏÑ§Í≥Ñ
        function designGameStructure(analysis) {
            const structure = {
                type: analysis.structure.name,
                steps: analysis.structure.steps,
                elements: [],
                quests: [],
                achievements: []
            };

            // Îã®Í≥ÑÎ≥Ñ ÏöîÏÜå ÏÉùÏÑ±
            for (let i = 1; i <= structure.steps; i++) {
                structure.elements.push({
                    id: `step${i}`,
                    name: `${structure.type} ${i}Îã®Í≥Ñ`,
                    description: `${structure.type}Ïùò ${i}Î≤àÏß∏ Îã®Í≥ÑÎ•º Ïã§Ï≤úÌï¥Î≥¥ÏÑ∏Ïöî`,
                    icon: getStepIcon(i)
                });
            }

            // ÌÄòÏä§Ìä∏ ÏÉùÏÑ±
            structure.quests = [
                { name: `${structure.steps}Îã®Í≥Ñ Î™®Îëê Í¥ÄÏ∞∞ÌïòÍ∏∞`, reward: 100 },
                { name: '10Î∂Ñ Î™ÖÏÉÅ ÏôÑÎ£åÌïòÍ∏∞', reward: 50 },
                { name: 'ÌïòÎ£® Ïó∞ÏÜç ÏàòÌñâÌïòÍ∏∞', reward: 75 },
                { name: 'ÏßÄÌòú Î¨∏Íµ¨ 10Í∞ú ÏùΩÍ∏∞', reward: 30 }
            ];

            // ÏÑ±Ï∑® ÏãúÏä§ÌÖú
            structure.achievements = [
                { name: 'ÏàòÌñâ ÏãúÏûë', condition: 'Ï≤´ Î≤àÏß∏ Îã®Í≥Ñ ÏôÑÎ£å', reward: 25 },
                { name: `${structure.type} Ïù¥Ìï¥`, condition: 'Ï†àÎ∞ò Îã®Í≥Ñ ÏôÑÎ£å', reward: 50 },
                { name: 'ÏôÑÏ†ÑÌïú Ïù¥Ìï¥', condition: 'Î™®Îì† Îã®Í≥Ñ ÏôÑÎ£å', reward: 100 }
            ];

            return structure;
        }

        // Í≤åÏûÑ ÏΩòÌÖêÏ∏† ÏÉùÏÑ±
        function generateGameContent(analysis, structure) {
            return {
                title: `${structure.type} ÏàòÌñâ Í≤åÏûÑ`,
                description: `${structure.type}Ïùò Í∞ÄÎ•¥Ïπ®ÏùÑ ÌÜµÌï¥ ÎßàÏùåÏ±ôÍπÄÏùÑ Ïã§Ï≤úÌïòÎäî Ïù∏ÌÑ∞ÎûôÌã∞Î∏å Í≤åÏûÑ`,
                elements: structure.elements,
                quests: structure.quests,
                achievements: structure.achievements,
                wisdomTexts: analysis.keyPhrases,
                practiceElements: analysis.practiceElements,
                scienceConnections: generateScienceConnections(structure.type)
            };
        }

        // Í≥ºÌïôÏ†Å Ïó∞Í¥ÄÏÑ± ÏÉùÏÑ±
        function generateScienceConnections(topic) {
            const connections = {
                'ÌåîÏ†ïÎèÑ': [
                    { field: 'ÎáåÍ≥ºÌïô', content: 'Ïò¨Î∞îÎ•∏ ÎßàÏùåÏ±ôÍπÄÏù¥ Ï†ÑÏ†ÑÎëêÌîºÏßàÏùÑ ÌôúÏÑ±ÌôîÏãúÏºú Í∞êÏ†ï Ï°∞Ï†à Îä•Î†•ÏùÑ Ìñ•ÏÉÅÏãúÌÇµÎãàÎã§.' },
                    { field: 'Ïã¨Î¶¨Ìïô', content: 'Ï†ïÍ≤¨Í≥º Ï†ïÏÇ¨Ïú†Îäî Ïù∏ÏßÄ ÌñâÎèô ÏπòÎ£åÏùò ÌïµÏã¨ ÏõêÎ¶¨ÏôÄ ÏùºÏπòÌï©ÎãàÎã§.' }
                ],
                'ÏÇ¨ÏÑ±Ï†ú': [
                    { field: 'Ïã¨Î¶¨Ìïô', content: 'Í≥†ÌÜµÏùò ÏõêÏù∏Í≥º Ìï¥Í≤∞Ï±ÖÏùÑ Ï∞æÎäî Í≥ºÏ†ïÏùÄ ÌòÑÎåÄ Ïã¨Î¶¨ÏπòÎ£åÏùò Í∏∞Î≥∏ Ï†ëÍ∑ºÎ≤ïÏûÖÎãàÎã§.' },
                    { field: 'ÎáåÍ≥ºÌïô', content: 'ÏßëÏ∞©ÏùÑ ÎÜìÏïÑÏ£ºÎäî Ïó∞ÏäµÏù¥ Í∏∞Î≥∏ Î™®Îìú ÎÑ§Ìä∏ÏõåÌÅ¨Ïùò ÌôúÎèôÏùÑ Ï°∞Ï†àÌï©ÎãàÎã§.' }
                ],
                'ÏÇºÌïô': [
                    { field: 'ÎáåÍ≥ºÌïô', content: 'Í≥ÑÏú®, ÏÑ†Ï†ï, ÏßÄÌòúÏùò ÏàúÏ∞®Ï†Å Î∞úÏ†ÑÏù¥ ÎáåÏùò Îã®Í≥ÑÏ†Å Î∞úÎã¨Í≥º ÏùºÏπòÌï©ÎãàÎã§.' },
                    { field: 'ÏÉùÎ¶¨Ìïô', content: 'Î™ÖÏÉÅ ÏàòÌñâÏù¥ Ïä§Ìä∏Î†àÏä§ Ìò∏Î•¥Î™¨ÏùÑ Í∞êÏÜåÏãúÌÇ§Í≥† Î©¥Ïó≠ Í∏∞Îä•ÏùÑ Ìñ•ÏÉÅÏãúÌÇµÎãàÎã§.' }
                ]
            };

            return connections[topic] || [
                { field: 'ÎáåÍ≥ºÌïô', content: 'ÎßàÏùåÏ±ôÍπÄ ÏàòÌñâÏù¥ ÎáåÏùò Ïã†Í≤ΩÍ∞ÄÏÜåÏÑ±ÏùÑ Ï¶ùÏßÑÏãúÌÇµÎãàÎã§.' },
                { field: 'Ïã¨Î¶¨Ìïô', content: 'Í∑úÏπôÏ†ÅÏù∏ ÏàòÌñâÏù¥ Ï†ïÏã† Í±¥Í∞ïÍ≥º Ïõ∞ÎπôÏùÑ Ìñ•ÏÉÅÏãúÌÇµÎãàÎã§.' }
            ];
        }

        // HTML ÏΩîÎìú ÏÉùÏÑ±
        function generateHTMLCode(content, options) {
            const colorThemes = {
                blue: { primary: '#667eea', secondary: '#764ba2' },
                green: { primary: '#56ab2f', secondary: '#a8e6cf' },
                purple: { primary: '#8360c3', secondary: '#2ebf91' },
                orange: { primary: '#f093fb', secondary: '#f5576c' }
            };

            const theme = colorThemes[options.color];
            
            return `<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>${content.title}</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(-45deg, ${theme.primary}, ${theme.secondary}, ${theme.primary}, ${theme.secondary});
            background-size: 400% 400%;
            animation: gradientShift 15s ease infinite;
            min-height: 100vh;
            color: white;
            overflow-x: hidden;
        }

        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            padding: 30px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(15px);
            border-radius: 20px;
            margin-bottom: 30px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
        }

        .game-title {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .player-stats {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .stat-item {
            background: rgba(255, 255, 255, 0.2);
            padding: 15px 25px;
            border-radius: 15px;
            text-align: center;
            min-width: 120px;
        }

        .stat-value {
            font-size: 1.8em;
            font-weight: bold;
            color: #ffeb3b;
        }

        .game-board {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .game-card {
            background: rgba(255, 255, 255, 0.15);
            border-radius: 20px;
            padding: 25px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .game-card:hover {
            transform: translateY(-10px) scale(1.02);
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.3);
        }

        .card-title {
            font-size: 1.5em;
            margin-bottom: 15px;
            color: #ffeb3b;
            text-align: center;
        }

        .elements-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin: 20px 0;
        }

        .element-item {
            background: rgba(255, 255, 255, 0.2);
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .element-item:hover {
            background: rgba(255, 255, 255, 0.3);
            border-color: #ffeb3b;
            transform: scale(1.05);
        }

        .element-item.completed {
            background: rgba(255, 235, 59, 0.3);
            border-color: #ffeb3b;
        }

        .progress-circle {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            background: conic-gradient(#4caf50 0deg, #4caf50 var(--progress, 0deg), transparent var(--progress, 0deg));
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 20px auto;
            position: relative;
        }

        .progress-circle::before {
            content: '';
            width: 80px;
            height: 80px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            position: absolute;
        }

        .progress-text {
            position: relative;
            z-index: 1;
            font-weight: bold;
        }

        .btn {
            background: linear-gradient(135deg, ${theme.primary}, ${theme.secondary});
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            cursor: pointer;
            margin: 10px;
            font-size: 1.1em;
            font-weight: bold;
            transition: all 0.3s ease;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.3);
        }

        .timer-display {
            font-size: 3em;
            font-weight: bold;
            margin: 20px 0;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
            color: #ffeb3b;
            text-align: center;
        }

        .wisdom-text {
            font-style: italic;
            text-align: center;
            padding: 20px;
            background: rgba(0,0,0,0.2);
            border-radius: 10px;
            margin: 15px 0;
            line-height: 1.6;
        }

        .science-content {
            background: rgba(0,0,0,0.2);
            padding: 20px;
            border-radius: 10px;
            margin: 15px 0;
        }

        .achievement-popup {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0);
            background: linear-gradient(135deg, #4caf50, #45a049);
            padding: 30px;
            border-radius: 20px;
            text-align: center;
            z-index: 1000;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
        }

        .achievement-popup.show {
            animation: achievementPop 2s ease-out forwards;
        }

        @keyframes achievementPop {
            0% { transform: translate(-50%, -50%) scale(0); }
            20% { transform: translate(-50%, -50%) scale(1.2); }
            40% { transform: translate(-50%, -50%) scale(1); }
            100% { transform: translate(-50%, -50%) scale(1); }
        }

        @media (max-width: 768px) {
            .game-title { font-size: 2em; }
            .timer-display { font-size: 2em; }
            .player-stats { flex-direction: column; align-items: center; }
            .elements-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="header">
            <h1 class="game-title">${content.title}</h1>
            <p>${content.description}</p>
            
            <div class="player-stats">
                <div class="stat-item">
                    <div class="stat-value" id="level">1</div>
                    <div>ÏàòÌñâ Î†àÎ≤®</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="experience">0</div>
                    <div>Í≤ΩÌóòÏπò</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="wisdom">0</div>
                    <div>ÏßÄÌòú Ìè¨Ïù∏Ìä∏</div>
                </div>
            </div>
        </header>

        <div class="game-board">
            <div class="game-card">
                <h3 class="card-title">üéØ ${content.elements.length}Îã®Í≥Ñ ÏàòÌñâ</h3>
                <div class="elements-grid" id="elementsGrid">
                    ${content.elements.map((element, index) => `
                        <div class="element-item" onclick="completeElement(${index})" data-index="${index}">
                            <div style="font-size: 1.2em; margin-bottom: 5px;">${element.icon} ${element.name}</div>
                            <div style="font-size: 0.9em; opacity: 0.8;">${element.description}</div>
                        </div>
                    `).join('')}
                </div>
                <div class="progress-circle" style="--progress: 0deg;">
                    <div class="progress-text" id="progressText">0%</div>
                </div>
            </div>

            <div class="game-card">
                <h3 class="card-title">‚è∞ Î™ÖÏÉÅ ÌÉÄÏù¥Î®∏</h3>
                <div class="timer-display" id="timer">00:00</div>
                <div style="text-align: center;">
                    <button class="btn" onclick="setTimer(5)">5Î∂Ñ</button>
                    <button class="btn" onclick="setTimer(10)">10Î∂Ñ</button>
                    <button class="btn" onclick="setTimer(20)">20Î∂Ñ</button>
                </div>
                <div style="text-align: center; margin-top: 15px;">
                    <button class="btn" onclick="startTimer()" id="startBtn">ÏãúÏûë</button>
                    <button class="btn" onclick="resetTimer()">Î¶¨ÏÖã</button>
                </div>
            </div>

            <div class="game-card">
                <h3 class="card-title">üíé ÏàòÌñâ ÏßÄÌòú</h3>
                <div class="wisdom-text" id="wisdomText">
                    ${content.wisdomTexts[0] || 'ÎßàÏùåÏ±ôÍπÄÏùÄ ÌòÑÏû¨ ÏàúÍ∞ÑÏóê Íπ®Ïñ¥ÏûàÎäî Í≤ÉÏûÖÎãàÎã§.'}
                </div>
                <button class="btn" onclick="showWisdom()">ÏÉàÎ°úÏö¥ ÏßÄÌòú</button>
            </div>

            <div class="game-card">
                <h3 class="card-title">üß¨ Í≥ºÌïôÏ†Å Í∑ºÍ±∞</h3>
                <div class="science-content" id="scienceContent">
                    <h4 style="color: #ffeb3b; margin-bottom: 10px;">${content.scienceConnections[0]?.field || 'ÎáåÍ≥ºÌïô'}</h4>
                    <p>${content.scienceConnections[0]?.content || 'Î™ÖÏÉÅÏùÄ ÎáåÏùò Íµ¨Ï°∞Î•º Í∏çÏ†ïÏ†ÅÏúºÎ°ú Î≥ÄÌôîÏãúÌÇµÎãàÎã§.'}</p>
                </div>
                <button class="btn" onclick="showScience()">Í≥ºÌïô ÏÑ§Î™Ö</button>
            </div>
        </div>
    </div>

    <div class="achievement-popup" id="achievementPopup">
        <h2>üéâ ÏÑ±Ï∑® Îã¨ÏÑ±!</h2>
        <p id="achievementText"></p>
    </div>

    <script>
        let gameState = {
            level: 1,
            experience: 0,
            wisdom: 0,
            completedElements: new Set(),
            currentTimer: 0,
            timerInterval: null,
            isTimerRunning: false
        };

        const wisdomTexts = ${JSON.stringify(content.wisdomTexts)};
        const scienceConnections = ${JSON.stringify(content.scienceConnections)};
        const totalElements = ${content.elements.length};

        function completeElement(index) {
            if (gameState.completedElements.has(index)) return;
            
            gameState.completedElements.add(index);
            gameState.experience += 20;
            gameState.wisdom += 10;
            
            const element = document.querySelector('[data-index="' + index + '"]');
            element.classList.add('completed');
            
            updateProgress();
            updateStats();
            
            if (gameState.completedElements.size === totalElements) {
                showAchievement('üèÜ Î™®Îì† Îã®Í≥Ñ ÏôÑÎ£å!', 'ÏôÑÏ†ÑÌïú Ïù¥Ìï¥Ïóê ÎèÑÎã¨ÌñàÏäµÎãàÎã§!');
                gameState.experience += 100;
                updateStats();
            }
            
            checkLevelUp();
        }

        function updateProgress() {
            const progress = (gameState.completedElements.size / totalElements) * 100;
            const degrees = (progress / 100) * 360;
            
            document.querySelector('.progress-circle').style.setProperty('--progress', degrees + 'deg');
            document.getElementById('progressText').textContent = Math.round(progress) + '%';
        }

        function updateStats() {
            document.getElementById('level').textContent = gameState.level;
            document.getElementById('experience').textContent = gameState.experience;
            document.getElementById('wisdom').textContent = gameState.wisdom;
        }

        function checkLevelUp() {
            const requiredExp = gameState.level * 100;
            if (gameState.experience >= requiredExp) {
                gameState.level++;
                gameState.experience -= requiredExp;
                showAchievement('Î†àÎ≤® ÏóÖ!', 'Î†àÎ≤® ' + gameState.level + 'Ïóê ÎèÑÎã¨ÌñàÏäµÎãàÎã§!');
                updateStats();
            }
        }

        function showAchievement(title, description) {
            const popup = document.getElementById('achievementPopup');
            document.getElementById('achievementText').innerHTML = '<strong>' + title + '</strong><br>' + description;
            popup.classList.add('show');
            setTimeout(() => popup.classList.remove('show'), 3000);
        }

        function setTimer(minutes) {
            gameState.currentTimer = minutes * 60;
            updateTimerDisplay();
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(gameState.currentTimer / 60);
            const seconds = gameState.currentTimer % 60;
            document.getElementById('timer').textContent = 
                minutes.toString().padStart(2, '0') + ':' + seconds.toString().padStart(2, '0');
        }

        function startTimer() {
            if (gameState.currentTimer <= 0) return;
            
            if (!gameState.isTimerRunning) {
                gameState.isTimerRunning = true;
                document.getElementById('startBtn').textContent = 'ÏùºÏãúÏ†ïÏßÄ';
                
                gameState.timerInterval = setInterval(() => {
                    gameState.currentTimer--;
                    updateTimerDisplay();
                    
                    if (gameState.currentTimer <= 0) {
                        resetTimer();
                        showAchievement('Î™ÖÏÉÅ ÏôÑÎ£å!', 'Î™ÖÏÉÅÏùÑ ÏÑ±Í≥µÏ†ÅÏúºÎ°ú ÏôÑÎ£åÌñàÏäµÎãàÎã§!');
                        gameState.experience += 50;
                        gameState.wisdom += 25;
                        updateStats();
                        checkLevelUp();
                    }
                }, 1000);
            } else {
                pauseTimer();
            }
        }

        function pauseTimer() {
            gameState.isTimerRunning = false;
            clearInterval(gameState.timerInterval);
            document.getElementById('startBtn').textContent = 'ÏãúÏûë';
        }

        function resetTimer() {
            pauseTimer();
            gameState.currentTimer = 0;
            updateTimerDisplay();
        }

        function showWisdom() {
            const randomWisdom = wisdomTexts[Math.floor(Math.random() * wisdomTexts.length)];
            document.getElementById('wisdomText').textContent = randomWisdom;
            gameState.wisdom += 5;
            updateStats();
        }

        function showScience() {
            const randomScience = scienceConnections[Math.floor(Math.random() * scienceConnections.length)];
            document.getElementById('scienceContent').innerHTML = 
                '<h4 style="color: #ffeb3b; margin-bottom: 10px;">' + randomScience.field + '</h4>' +
                '<p>' + randomScience.content + '</p>';
        }

        // ÏûêÎèô ÏΩòÌÖêÏ∏† ÏàúÌôò
        setInterval(showWisdom, 30000);
        setInterval(showScience, 45000);
    </script>
</body>
</html>`;
        }

        // Îã®Í≥ÑÎ≥Ñ ÏïÑÏù¥ÏΩò ÏÉùÏÑ±
        function getStepIcon(step) {
            const icons = ['üå±', 'üåø', 'üå≥', 'üå∏', 'üçÉ', 'üå∫', 'üåª', 'üåπ', 'üå∑', 'üåº', 'üåµ', 'üéã'];
            return icons[step - 1] || 'üîπ';
        }

        // UI ÏóÖÎç∞Ïù¥Ìä∏ Ìï®ÏàòÎì§
        function showProgress() {
            progressContainer.style.display = 'block';
            resultContainer.style.display = 'none';
            generateBtn.disabled = true;
            generateBtn.innerHTML = '<div class="loading-spinner"></div>ÏÉùÏÑ± Ï§ë...';
        }

        function updateProgress(percent, text) {
            document.getElementById('progressFill').style.width = percent + '%';
            document.getElementById('progressText').textContent = text;
        }

        function hideProgress() {
            progressContainer.style.display = 'none';
            generateBtn.disabled = false;
            generateBtn.innerHTML = 'üöÄ ÎßàÏùåÏ±ôÍπÄ Í≤åÏûÑ ÏûêÎèô ÏÉùÏÑ±ÌïòÍ∏∞';
        }

        function showResult() {
            hideProgress();
            resultContainer.style.display = 'block';
            
            // Î∂ÑÏÑù Í≤∞Í≥º ÌëúÏãú
            const analysisHTML = `
                <div class="analysis-result">
                    <h3>üìä Î≤ïÎ¨∏ Î∂ÑÏÑù Í≤∞Í≥º</h3>
                    <p><strong>Í∞êÏßÄÎêú Ï£ºÏ†ú:</strong> ${analysisData.structure.name}</p>
                    <p><strong>Í≤åÏûÑ Íµ¨Ï°∞:</strong> ${analysisData.structure.steps}Îã®Í≥Ñ ÏàòÌñâ ÏãúÏä§ÌÖú</p>
                    <div class="detected-elements">
                        ${analysisData.detectedTopics.map(topic => `<span class="element-tag">${topic}</span>`).join('')}
                        ${analysisData.practiceElements.map(element => `<span class="element-tag">${element}</span>`).join('')}
                    </div>
                    <p style="margin-top: 15px;"><strong>ÏÉùÏÑ±Îêú ÏΩòÌÖêÏ∏†:</strong> ${analysisData.keyPhrases.length}Í∞ú ÏßÄÌòú Î¨∏Íµ¨, ${analysisData.practiceElements.length}Í∞ú ÏàòÌñâ ÏöîÏÜå</p>
                </div>

                <!-- Î≤ïÎ¨∏ ÏïÑÌÇ§ÌÖçÏ≤ò ÏãúÍ∞ÅÌôî -->
                <div class="architecture-diagram" id="architectureDiagram">
                    <!-- PDF Ï†ÑÏö© Ìó§Îçî -->
                    <div class="pdf-only pdf-title">üìø ${analysisData.structure.name} ÏàòÌñâ ÏïÑÌÇ§ÌÖçÏ≤ò</div>
                    <div class="pdf-only pdf-date">ÏÉùÏÑ±Ïùº: ${new Date().toLocaleDateString('ko-KR', { 
                        year: 'numeric', 
                        month: 'long', 
                        day: 'numeric',
                        weekday: 'long'
                    })}</div>
                    
                    <h3 style="text-align: center; color: #667eea; margin-bottom: 20px;">üèóÔ∏è Î≤ïÎ¨∏ ÏàòÌñâ ÏïÑÌÇ§ÌÖçÏ≤ò</h3>
                    
                    <!-- Íµ¨Ï°∞ Ìä∏Î¶¨ -->
                    <div class="structure-tree">
                        <div class="tree-node root">üìø ${analysisData.structure.name}</div>
                        <div class="tree-connector"></div>
                        
                        <div class="tree-level">
                            ${generateStructureNodes(analysisData)}
                        </div>
                    </div>

                    <!-- ÏàòÌñâ ÌîåÎ°úÏö∞ Îã§Ïù¥Ïñ¥Í∑∏Îû® -->
                    <h4 style="text-align: center; color: #667eea; margin: 30px 0 20px;">üîÑ ÏàòÌñâ ÌîåÎ°úÏö∞</h4>
                    <div class="flow-diagram">
                        ${generateFlowSteps(analysisData)}
                    </div>

                    <!-- ÏàòÌñâ ÏöîÏÜåÎì§ -->
                    <h4 style="text-align: center; color: #667eea; margin: 30px 0 20px;">üßò ÏàòÌñâ ÏöîÏÜå</h4>
                    <div class="practice-elements">
                        ${analysisData.practiceElements.map(element => `
                            <div class="practice-card">
                                <div style="font-size: 2em; margin-bottom: 10px;">${getPracticeIcon(element)}</div>
                                <h5>${element}</h5>
                                <p style="font-size: 0.9em; margin-top: 5px;">${getPracticeDescription(element)}</p>
                            </div>
                        `).join('')}
                    </div>

                    <!-- ÌÇ§ÏõåÎìú ÌÅ¥ÎùºÏö∞Îìú -->
                    <h4 style="text-align: center; color: #667eea; margin: 30px 0 20px;">üè∑Ô∏è ÌïµÏã¨ ÌÇ§ÏõåÎìú</h4>
                    <div class="keyword-cloud">
                        ${generateKeywordTags(analysisData)}
                    </div>

                    <!-- Í≥ºÌïôÏ†Å Ïó∞Í¥ÄÏÑ± -->
                    <h4 style="text-align: center; color: #667eea; margin: 30px 0 20px;">üß¨ Í≥ºÌïôÏ†Å Ïó∞Í¥ÄÏÑ±</h4>
                    <div class="science-connections">
                        ${generateScienceCards(analysisData)}
                    </div>

                    <!-- ÏàòÌñâ ÌÉÄÏûÑÎùºÏù∏ -->
                    <h4 style="text-align: center; color: #667eea; margin: 30px 0 20px;">‚è∞ ÏàòÌñâ ÌÉÄÏûÑÎùºÏù∏</h4>
                    <div class="timeline">
                        ${generateTimeline(analysisData)}
                    </div>
                </div>
            `;
            
            document.getElementById('analysisResult').innerHTML = analysisHTML;
        }

        // Íµ¨Ï°∞ ÎÖ∏Îìú ÏÉùÏÑ±
        function generateStructureNodes(analysis) {
            const nodes = [];
            for (let i = 1; i <= analysis.structure.steps; i++) {
                nodes.push(`
                    <div class="tree-node" onclick="highlightStep(${i})">
                        ${getStepIcon(i)} ${i}Îã®Í≥Ñ
                        <div style="font-size: 0.8em; margin-top: 5px; opacity: 0.9;">
                            ${getStepName(analysis.structure.name, i)}
                        </div>
                    </div>
                `);
            }
            return nodes.join('');
        }

        // ÌîåÎ°úÏö∞ Îã®Í≥Ñ ÏÉùÏÑ±
        function generateFlowSteps(analysis) {
            const flowSteps = getFlowSteps(analysis.structure.name);
            return flowSteps.map(step => `
                <div class="flow-step">
                    <div style="font-size: 1.5em; margin-bottom: 10px;">${step.icon}</div>
                    <h5>${step.title}</h5>
                    <p style="font-size: 0.9em; margin-top: 5px;">${step.description}</p>
                </div>
            `).join('');
        }

        // ÌÇ§ÏõåÎìú ÌÉúÍ∑∏ ÏÉùÏÑ±
        function generateKeywordTags(analysis) {
            const keywords = [
                ...analysis.detectedTopics,
                ...analysis.practiceElements,
                'ÎßàÏùåÏ±ôÍπÄ', 'ÏßÄÌòú', 'Ìï¥ÌÉà', 'Íπ®Îã¨Ïùå', 'ÏàòÌñâ'
            ];
            return [...new Set(keywords)].map(keyword => 
                `<span class="keyword-tag" onclick="explainKeyword('${keyword}')">${keyword}</span>`
            ).join('');
        }

        // Í≥ºÌïô Ïπ¥Îìú ÏÉùÏÑ±
        function generateScienceCards(analysis) {
            const scienceConnections = generateScienceConnections(analysis.structure.name);
            return scienceConnections.map(connection => `
                <div class="science-card">
                    <h5 style="color: #e17055; margin-bottom: 10px;">üî¨ ${connection.field}</h5>
                    <p>${connection.content}</p>
                </div>
            `).join('');
        }

        // ÌÉÄÏûÑÎùºÏù∏ ÏÉùÏÑ±
        function generateTimeline(analysis) {
            const timelineItems = [
                { title: 'ÏàòÌñâ ÏãúÏûë', description: 'Î≤ïÎ¨∏ Ïù¥Ìï¥ÏôÄ ÎèôÍ∏∞ ÌôïÎ¶Ω', icon: 'üå±' },
                { title: 'Í∏∞Ï¥à Ïã§Ï≤ú', description: 'Í∏∞Î≥∏ ÏàòÌñâÎ≤ï ÏùµÌûàÍ∏∞', icon: 'üìö' },
                { title: 'ÍπäÏùÄ Ïù¥Ìï¥', description: 'Ï≤¥ÌóòÏùÑ ÌÜµÌïú Íπ®Îã¨Ïùå', icon: 'üí°' },
                { title: 'ÏôÑÏ†ÑÌïú Ï≤¥Îìù', description: 'ÏùºÏÉÅ ÏÜç ÏûêÏó∞Ïä§Îü¨Ïö¥ Ïã§Ï≤ú', icon: 'üåü' },
                { title: 'ÏßÄÌòú ÏôÑÏÑ±', description: 'Ìï¥ÌÉàÍ≥º Íπ®Îã¨Ïùå ÏÑ±Ï∑®', icon: 'üèÜ' }
            ];

            return timelineItems.map((item, index) => `
                <div class="timeline-item">
                    <div class="timeline-content">
                        <div style="font-size: 2em; margin-bottom: 10px;">${item.icon}</div>
                        <h5>${item.title}</h5>
                        <p style="margin-top: 10px;">${item.description}</p>
                    </div>
                    <div class="timeline-marker"></div>
                </div>
            `).join('');
        }

        // Îã®Í≥ÑÎ≥Ñ Ïù¥Î¶Ñ ÏÉùÏÑ±
        function getStepName(structureName, step) {
            const stepNames = {
                'ÌåîÏ†ïÎèÑ': ['Ï†ïÍ≤¨', 'Ï†ïÏÇ¨Ïú†', 'Ï†ïÏñ¥', 'Ï†ïÏóÖ', 'Ï†ïÎ™Ö', 'Ï†ïÏ†ïÏßÑ', 'Ï†ïÎÖê', 'Ï†ïÏ†ï'],
                'ÏÇ¨ÏÑ±Ï†ú': ['Í≥†ÏÑ±Ï†ú', 'ÏßëÏÑ±Ï†ú', 'Î©∏ÏÑ±Ï†ú', 'ÎèÑÏÑ±Ï†ú'],
                'ÏÇºÌïô': ['Í≥ÑÌïô', 'Ï†ïÌïô', 'ÌòúÌïô'],
                'ÏÇ¨ÎÖêÏ≤ò': ['Ïã†ÎÖêÏ≤ò', 'ÏàòÎÖêÏ≤ò', 'Ïã¨ÎÖêÏ≤ò', 'Î≤ïÎÖêÏ≤ò'],
                'Ïò§Ïò®': ['ÏÉâÏò®', 'ÏàòÏò®', 'ÏÉÅÏò®', 'ÌñâÏò®', 'ÏãùÏò®'],
                'Ïã≠Ïù¥Ïó∞Í∏∞': ['Î¨¥Î™Ö', 'Ìñâ', 'Ïãù', 'Î™ÖÏÉâ', 'Ïú°ÏûÖ', 'Ï¥â', 'Ïàò', 'Ïï†', 'Ï∑®', 'Ïú†', 'ÏÉù', 'ÎÖ∏ÏÇ¨']
            };
            
            const names = stepNames[structureName] || [`${step}Îã®Í≥Ñ`];
            return names[step - 1] || `${step}Îã®Í≥Ñ`;
        }

        // ÌîåÎ°úÏö∞ Îã®Í≥Ñ Ï†ïÏùò
        function getFlowSteps(structureName) {
            const flowSteps = {
                'ÌåîÏ†ïÎèÑ': [
                    { icon: 'üëÅÔ∏è', title: 'Ïò¨Î∞îÎ•∏ Í≤¨Ìï¥', description: 'ÏÇ¨ÏÑ±Ï†úÎ•º Ïù¥Ìï¥ÌïòÍ∏∞' },
                    { icon: 'üí≠', title: 'Ïò¨Î∞îÎ•∏ ÏÇ¨Ïú†', description: 'Î∞îÎ•∏ ÎßàÏùåÍ∞ÄÏßê' },
                    { icon: 'üó£Ô∏è', title: 'Ïò¨Î∞îÎ•∏ Îßê', description: 'ÏßÑÏã§Ìïú Ïñ∏Ïñ¥' },
                    { icon: 'ü§≤', title: 'Ïò¨Î∞îÎ•∏ ÌñâÎèô', description: 'Ïú§Î¶¨Ï†Å Ïã§Ï≤ú' }
                ],
                'ÏÇ¨ÏÑ±Ï†ú': [
                    { icon: 'üòî', title: 'Í≥†ÏÑ±Ï†ú', description: 'Í¥¥Î°úÏõÄÏùò ÏßÑÎ¶¨' },
                    { icon: 'üîó', title: 'ÏßëÏÑ±Ï†ú', description: 'ÏõêÏù∏Ïùò ÏßÑÎ¶¨' },
                    { icon: 'üïäÔ∏è', title: 'Î©∏ÏÑ±Ï†ú', description: 'ÏÜåÎ©∏Ïùò ÏßÑÎ¶¨' },
                    { icon: 'üõ§Ô∏è', title: 'ÎèÑÏÑ±Ï†ú', description: 'Î∞©Î≤ïÏùò ÏßÑÎ¶¨' }
                ],
                'ÏÇºÌïô': [
                    { icon: '‚öñÔ∏è', title: 'Í≥ÑÌïô', description: 'Ïú§Î¶¨Ï†Å ÌñâÎèô' },
                    { icon: 'üßò', title: 'Ï†ïÌïô', description: 'ÎßàÏùå ÏßëÏ§ë' },
                    { icon: 'üí°', title: 'ÌòúÌïô', description: 'ÏßÄÌòú Í≥ÑÎ∞ú' }
                ]
            };
            
            return flowSteps[structureName] || [
                { icon: 'üå±', title: 'ÏãúÏûë', description: 'ÏàòÌñâ ÏãúÏûëÌïòÍ∏∞' },
                { icon: 'üåø', title: 'Î∞úÏ†Ñ', description: 'Ï†êÏßÑÏ†Å ÏÑ±Ïû•' },
                { icon: 'üå∏', title: 'ÏôÑÏÑ±', description: 'Î™©Ìëú Îã¨ÏÑ±' }
            ];
        }

        // ÏàòÌñâ ÏïÑÏù¥ÏΩò Î∞òÌôò
        function getPracticeIcon(element) {
            const icons = {
                'Î™ÖÏÉÅ': 'üßò',
                'Í¥ÄÏ∞∞': 'üëÅÔ∏è',
                'Ìò∏Ìù°': 'ü´Å',
                'Í±∑Í∏∞': 'üö∂',
                'ÏûêÎπÑ': 'üíù',
                'ÏßÄÌòú': 'üí°',
                'ÏßëÏ§ë': 'üéØ'
            };
            return icons[element] || 'üî∏';
        }

        // ÏàòÌñâ ÏÑ§Î™Ö Î∞òÌôò
        function getPracticeDescription(element) {
            const descriptions = {
                'Î™ÖÏÉÅ': 'Í≥†ÏöîÌïú ÎßàÏùåÏúºÎ°ú ÎÇ¥Î©¥ÏùÑ Í¥ÄÏ∞∞ÌïòÎäî ÏàòÌñâ',
                'Í¥ÄÏ∞∞': 'ÌòÑÏû¨ ÏàúÍ∞ÑÏóê Íπ®Ïñ¥ÏûàÎäî ÎßàÏùåÏ±ôÍπÄ',
                'Ìò∏Ìù°': 'Îì§Ïà®Í≥º ÎÇ†Ïà®ÏùÑ ÌÜµÌïú ÏßëÏ§ë ÏàòÌñâ',
                'Í±∑Í∏∞': 'Î≥¥ÌñâÏùÑ ÌÜµÌïú ÎèôÏ†Å Î™ÖÏÉÅ',
                'ÏûêÎπÑ': 'ÏûêÏã†Í≥º ÌÉÄÏù∏Ïóê ÎåÄÌïú ÏÇ¨ÎûëÍ≥º Ïó∞ÎØº',
                'ÏßÄÌòú': 'ÏÇ¨Î¨ºÏùò Î≥∏ÏßàÏùÑ Íø∞Îö´Ïñ¥ Î≥¥Îäî ÌÜµÏ∞∞',
                'ÏßëÏ§ë': 'Ìïú Ï†êÏóê ÎßàÏùåÏùÑ Î™®ÏúºÎäî ÏÑ†Ï†ï'
            };
            return descriptions[element] || 'ÎßàÏùåÏùÑ Ï†ïÌôîÌïòÎäî ÏàòÌñâÎ≤ï';
        }

        // Ïù∏ÌÑ∞ÎûôÌã∞Î∏å Í∏∞Îä•Îì§
        function highlightStep(step) {
            showNotification(`${step}Îã®Í≥Ñ: ${getStepName(analysisData.structure.name, step)} Îã®Í≥ÑÎ•º ÏÑ†ÌÉùÌñàÏäµÎãàÎã§!`);
        }

        function explainKeyword(keyword) {
            const explanations = {
                'ÌåîÏ†ïÎèÑ': 'Î∂ÄÏ≤òÎãòÏù¥ Í∞ÄÎ•¥ÏπòÏã† Íπ®Îã¨ÏùåÏóê Ïù¥Î•¥Îäî Ïó¨Îçü Í∞ÄÏßÄ Î∞îÎ•∏ Í∏∏',
                'ÏÇ¨ÏÑ±Ï†ú': 'Í¥¥Î°úÏõÄÍ≥º Í∑∏ ÏõêÏù∏, ÏÜåÎ©∏Í≥º Î∞©Î≤ïÏóê ÎåÄÌïú ÎÑ§ Í∞ÄÏßÄ ÏÑ±Ïä§Îü¨Ïö¥ ÏßÑÎ¶¨',
                'ÏÇºÌïô': 'Í≥ÑÏú®, ÏÑ†Ï†ï, ÏßÄÌòúÎ°ú Ïù¥Î£®Ïñ¥ÏßÑ ÏÑ∏ Í∞ÄÏßÄ ÌïôÏäµ',
                'ÎßàÏùåÏ±ôÍπÄ': 'ÌòÑÏû¨ ÏàúÍ∞ÑÏóê Íπ®Ïñ¥ÏûàÎäî ÏùòÏãùÏ†Å Ï£ºÏùò',
                'ÏßÄÌòú': 'ÏÇ¨Î¨ºÏùò Ï∞∏Îêú Î≥∏ÏÑ±ÏùÑ Íø∞Îö´Ïñ¥ Î≥¥Îäî Îä•Î†•',
                'Ìï¥ÌÉà': 'Î™®Îì† Í¥¥Î°úÏõÄÏóêÏÑú ÏôÑÏ†ÑÌûà Î≤óÏñ¥ÎÇú ÏûêÏú†Î°úÏö¥ ÏÉÅÌÉú'
            };
            
            const explanation = explanations[keyword] || `${keyword}Ïóê ÎåÄÌïú ÍπäÏùÄ Ïù¥Ìï¥Í∞Ä ÌïÑÏöîÌïú Ï§ëÏöîÌïú Í∞úÎÖêÏûÖÎãàÎã§.`;
            showNotification(`üí° ${keyword}: ${explanation}`);
        }

        function showPreview() {
            const previewArea = document.getElementById('previewArea');
            const previewFrame = document.getElementById('previewFrame');
            
            if (previewArea.style.display === 'none') {
                previewArea.style.display = 'block';
                previewFrame.srcdoc = generatedHTML;
                document.getElementById('previewBtn').textContent = 'üôà ÎØ∏Î¶¨Î≥¥Í∏∞ Ïà®Í∏∞Í∏∞';
            } else {
                previewArea.style.display = 'none';
                document.getElementById('previewBtn').textContent = 'üëÄ ÎØ∏Î¶¨Î≥¥Í∏∞';
            }
        }

        function downloadHTML() {
            const blob = new Blob([generatedHTML], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `${analysisData.structure.name}_Í≤åÏûÑ.html`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            showNotification('HTML ÌååÏùºÏù¥ Îã§Ïö¥Î°úÎìúÎêòÏóàÏäµÎãàÎã§!');
        }

        function downloadPDF() {
            if (!analysisData.structure) {
                showNotification('Î®ºÏ†Ä Í≤åÏûÑÏùÑ ÏÉùÏÑ±Ìï¥Ï£ºÏÑ∏Ïöî!', 'error');
                return;
            }

            // PDF Ï†úÎ™© ÌëúÏãú
            const pdfElements = document.querySelectorAll('.pdf-only');
            pdfElements.forEach(el => el.style.display = 'block');
            
            // ÌòÑÏû¨ Ï†úÎ™© Î≥ÄÍ≤Ω
            const originalTitle = document.title;
            document.title = `${analysisData.structure.name}_ÏïÑÌÇ§ÌÖçÏ≤ò_${new Date().toLocaleDateString('ko-KR').replace(/\./g, '_')}`;
            
            // Ïù∏ÏáÑ Îã§Ïù¥ÏñºÎ°úÍ∑∏ Ïó¥Í∏∞
            setTimeout(() => {
                window.print();
                
                // ÏõêÎûò ÏÉÅÌÉúÎ°ú Î≥µÏõê
                setTimeout(() => {
                    pdfElements.forEach(el => el.style.display = 'none');
                    document.title = originalTitle;
                }, 1000);
            }, 500);
            
            showNotification('üìÑ PDF Ï†ÄÏû• Îã§Ïù¥ÏñºÎ°úÍ∑∏Í∞Ä Ïó¥Î†∏ÏäµÎãàÎã§. "PDFÎ°ú Ï†ÄÏû•"ÏùÑ ÏÑ†ÌÉùÌïòÏÑ∏Ïöî!');
        }

        function copyCode() {
            const codeArea = document.getElementById('codeArea');
            const codeOutput = document.getElementById('codeOutput');
            
            if (codeArea.style.display === 'none') {
                codeArea.style.display = 'block';
                codeOutput.textContent = generatedHTML;
                document.getElementById('copyCodeBtn').textContent = 'üìã ÏΩîÎìú Ïà®Í∏∞Í∏∞';
            } else {
                navigator.clipboard.writeText(generatedHTML).then(() => {
                    showNotification('ÏΩîÎìúÍ∞Ä ÌÅ¥Î¶ΩÎ≥¥ÎìúÏóê Î≥µÏÇ¨ÎêòÏóàÏäµÎãàÎã§!');
                });
            }
        }

        function resetForm() {
            dharmaText.value = '';
            hideProgress();
            resultContainer.style.display = 'none';
            document.getElementById('previewArea').style.display = 'none';
            document.getElementById('codeArea').style.display = 'none';
            document.getElementById('previewBtn').textContent = 'üëÄ ÎØ∏Î¶¨Î≥¥Í∏∞';
            document.getElementById('copyCodeBtn').textContent = 'üìã ÏΩîÎìú Î≥µÏÇ¨';
            
            showNotification('ÏÉàÎ°úÏö¥ Í≤åÏûÑÏùÑ ÎßåÎì§ Ï§ÄÎπÑÍ∞Ä ÎêòÏóàÏäµÎãàÎã§!');
        }

        function showNotification(message, type = 'success') {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.className = 'notification show';
            
            // ÏïåÎ¶º ÌÉÄÏûÖÎ≥Ñ ÏÉâÏÉÅ ÏÑ§Ï†ï
            if (type === 'error') {
                notification.style.background = 'linear-gradient(135deg, #e74c3c, #c0392b)';
            } else if (type === 'info') {
                notification.style.background = 'linear-gradient(135deg, #3498db, #2980b9)';
            } else {
                notification.style.background = 'linear-gradient(135deg, #4caf50, #45a049)';
            }
            
            // ÏΩòÏÜîÏóêÎèÑ Î°úÍ∑∏ Ï∂úÎ†•
            console.log(`[${type.toUpperCase()}] ${message}`);
            
            // 3Ï¥à ÌõÑ ÏûêÎèô Ïà®ÍπÄ
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }

        function delay(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }
    </script>
</body>
</html>
