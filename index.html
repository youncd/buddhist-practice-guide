<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ§˜â€â™€ï¸ ë²•ë¬¸ ê²Œì„ ìë™ ìƒì„±ê¸°</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(-45deg, #667eea, #764ba2, #667eea, #764ba2);
            background-size: 400% 400%;
            animation: gradientFlow 15s ease infinite;
            min-height: 100vh;
            color: #333;
        }

        @keyframes gradientFlow {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            backdrop-filter: blur(10px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            background: linear-gradient(45deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .main-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        .panel {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            backdrop-filter: blur(10px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        }

        .panel h2 {
            color: #667eea;
            margin-bottom: 20px;
            font-size: 1.5em;
        }

        .upload-area {
            border: 3px dashed #667eea;
            border-radius: 15px;
            padding: 40px;
            text-align: center;
            margin-bottom: 20px;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
            min-height: 200px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .upload-area:hover {
            border-color: #764ba2;
            background: rgba(102, 126, 234, 0.05);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.2);
        }

        .upload-area.dragover {
            border-color: #764ba2;
            background: rgba(102, 126, 234, 0.15);
            transform: scale(1.02);
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.3);
        }

        .upload-area.dragover::before {
            content: 'ğŸ“¥ íŒŒì¼ì„ ë†“ì•„ì£¼ì„¸ìš”!';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(102, 126, 234, 0.9);
            color: white;
            padding: 15px 30px;
            border-radius: 25px;
            font-weight: bold;
            font-size: 1.2em;
            z-index: 1;
            animation: bounce 0.5s ease infinite alternate;
        }

        @keyframes bounce {
            from { transform: translate(-50%, -50%) scale(1); }
            to { transform: translate(-50%, -50%) scale(1.1); }
        }

        .dharma-input {
            width: 100%;
            height: 200px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            padding: 15px;
            font-size: 14px;
            line-height: 1.6;
            resize: vertical;
            transition: border-color 0.3s ease;
        }

        .dharma-input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .options-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .option-card {
            background: linear-gradient(135deg, #f8f9ff, #e8ecff);
            border: 2px solid #e0e4ff;
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .option-card:hover {
            border-color: #667eea;
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.2);
        }

        .option-card.selected {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border-color: #667eea;
        }

        .btn {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            font-size: 1.1em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.3);
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 40px rgba(102, 126, 234, 0.4);
        }

        .btn:active {
            transform: translateY(-1px);
        }

        .btn-large {
            width: 100%;
            padding: 20px;
            font-size: 1.3em;
            margin: 20px 0;
        }

        .progress-container {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            backdrop-filter: blur(10px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            display: none;
        }

        .progress-bar {
            width: 100%;
            height: 20px;
            background: #f0f0f0;
            border-radius: 10px;
            overflow: hidden;
            margin: 20px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            width: 0%;
            transition: width 0.5s ease;
            border-radius: 10px;
        }

        .result-container {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            backdrop-filter: blur(10px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            display: none;
        }

        .preview-frame {
            width: 100%;
            height: 500px;
            border: none;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            margin: 20px 0;
        }

        .code-output {
            background: #1e1e1e;
            color: #f8f8f2;
            border-radius: 10px;
            padding: 20px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            max-height: 300px;
            overflow-y: auto;
            margin: 20px 0;
            white-space: pre-wrap;
        }

        .download-buttons {
            display: flex;
            gap: 15px;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .analysis-result {
            background: linear-gradient(135deg, #e8f5e8, #f0f8ff);
            border-left: 5px solid #4caf50;
            border-radius: 10px;
            padding: 20px;
            margin: 15px 0;
        }

        .detected-elements {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin: 15px 0;
        }

        .element-tag {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.9em;
            font-weight: bold;
        }

        .tips {
            background: linear-gradient(135deg, #fff3cd, #ffeaa7);
            border-left: 5px solid #ffc107;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }

        .architecture-diagram {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 30px;
            margin: 20px 0;
            backdrop-filter: blur(10px);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
        }

        .structure-tree {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 20px 0;
        }

        .tree-node {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 15px 25px;
            border-radius: 25px;
            margin: 10px;
            text-align: center;
            position: relative;
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.3);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .tree-node:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(102, 126, 234, 0.4);
        }

        .tree-node.root {
            font-size: 1.2em;
            font-weight: bold;
            background: linear-gradient(135deg, #ff6b6b, #feca57);
        }

        .tree-level {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 15px;
            margin: 20px 0;
        }

        .tree-connector {
            width: 2px;
            height: 30px;
            background: linear-gradient(to bottom, #667eea, #764ba2);
            margin: 0 auto;
        }

        .tree-branch {
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 10px 0;
        }

        .tree-branch::before {
            content: '';
            flex: 1;
            height: 2px;
            background: linear-gradient(to right, #667eea, #764ba2);
            margin: 0 10px;
        }

        .tree-branch::after {
            content: '';
            flex: 1;
            height: 2px;
            background: linear-gradient(to left, #667eea, #764ba2);
            margin: 0 10px;
        }

        .flow-diagram {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 30px 0;
            flex-wrap: wrap;
            gap: 20px;
        }

        .flow-step {
            flex: 1;
            min-width: 200px;
            background: linear-gradient(135deg, #f093fb, #f5576c);
            color: white;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            position: relative;
            box-shadow: 0 10px 25px rgba(240, 147, 251, 0.3);
        }

        .flow-step::after {
            content: 'â†’';
            position: absolute;
            right: -15px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 1.5em;
            color: #667eea;
            font-weight: bold;
        }

        .flow-step:last-child::after {
            display: none;
        }

        .practice-elements {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .practice-card {
            background: linear-gradient(135deg, #a8edea, #fed6e3);
            color: #333;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 10px 25px rgba(168, 237, 234, 0.3);
            transition: transform 0.3s ease;
        }

        .practice-card:hover {
            transform: scale(1.05);
        }

        .science-connections {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .science-card {
            background: linear-gradient(135deg, #ffeaa7, #fab1a0);
            color: #333;
            padding: 20px;
            border-radius: 15px;
            border-left: 5px solid #e17055;
        }

        .keyword-cloud {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 10px;
            margin: 20px 0;
            padding: 20px;
            background: linear-gradient(135deg, #e8f5ff, #f0f8ff);
            border-radius: 15px;
        }

        .keyword-tag {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.9em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .keyword-tag:hover {
            transform: scale(1.1);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .timeline {
            position: relative;
            margin: 30px 0;
            padding: 0 20px;
        }

        .timeline::before {
            content: '';
            position: absolute;
            left: 50%;
            top: 0;
            bottom: 0;
            width: 4px;
            background: linear-gradient(to bottom, #667eea, #764ba2);
            transform: translateX(-50%);
        }

        .timeline-item {
            position: relative;
            margin: 30px 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .timeline-item:nth-child(odd) .timeline-content {
            margin-right: 55%;
        }

        .timeline-item:nth-child(even) .timeline-content {
            margin-left: 55%;
        }

        .timeline-content {
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            position: relative;
        }

        .timeline-marker {
            position: absolute;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
            width: 20px;
            height: 20px;
            background: #ffeb3b;
            border-radius: 50%;
            border: 4px solid white;
            box-shadow: 0 5px 15px rgba(255, 235, 59, 0.5);
            z-index: 1;
        }

        .loading-spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
            margin-right: 10px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: linear-gradient(135deg, #4caf50, #45a049);
            color: white;
            padding: 15px 25px;
            border-radius: 10px;
            box-shadow: 0 10px 30px rgba(76, 175, 80, 0.3);
            transform: translateX(100%);
            transition: transform 0.3s ease;
            z-index: 1000;
        }

        .notification.show {
            transform: translateX(0);
        }

        .pdf-only {
            display: none;
        }

        /* PDF ì¸ì‡„ìš© ìŠ¤íƒ€ì¼ */
        @media print {
            body {
                background: white !important;
                color: black !important;
            }
            
            .container {
                max-width: none !important;
                padding: 0 !important;
            }
            
            .header, .main-grid, .progress-container, .result-container .download-buttons,
            .tips, .notification {
                display: none !important;
            }
            
            .architecture-diagram {
                background: white !important;
                box-shadow: none !important;
                border: 1px solid #ddd !important;
                page-break-inside: avoid;
                margin: 20px 0 !important;
            }
            
            .tree-node, .flow-step, .practice-card, .science-card {
                background: #f8f9fa !important;
                color: black !important;
                border: 1px solid #ddd !important;
                box-shadow: none !important;
            }
            
            .keyword-tag {
                background: #e9ecef !important;
                color: black !important;
            }
            
            .timeline-content {
                background: white !important;
                border: 1px solid #ddd !important;
            }
            
            h3, h4 {
                color: black !important;
            }
            
            .pdf-title {
                display: block !important;
                text-align: center;
                font-size: 24px;
                font-weight: bold;
                margin-bottom: 30px;
                padding-bottom: 10px;
                border-bottom: 2px solid black;
            }
            
            .pdf-date {
                display: block !important;
                text-align: right;
                font-size: 12px;
                margin-bottom: 20px;
            }
        }

        @media (max-width: 768px) {
            .main-grid {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 2em;
            }
            
            .download-buttons {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
            }
            
            .flow-diagram {
                flex-direction: column;
            }
            
            .flow-step::after {
                content: 'â†“';
                right: 50%;
                bottom: -15px;
                top: auto;
                transform: translateX(50%);
            }
            
            .timeline::before {
                left: 20px;
            }
            
            .timeline-item:nth-child(odd) .timeline-content,
            .timeline-item:nth-child(even) .timeline-content {
                margin-left: 50px;
                margin-right: 0;
            }
            
            .timeline-marker {
                left: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- í—¤ë” -->
        <header class="header">
            <h1>ğŸ§˜â€â™€ï¸ ë²•ë¬¸ ê²Œì„ ìë™ ìƒì„±ê¸°</h1>
            <p style="font-size: 1.1em; opacity: 0.8; margin-top: 10px;">
                ë¶ˆêµ ë²•ë¬¸ì„ ì—…ë¡œë“œí•˜ë©´ ìë™ìœ¼ë¡œ ë§ì¶¤í˜• ë§ˆìŒì±™ê¹€ ìˆ˜í–‰ ê²Œì„ì„ ìƒì„±í•©ë‹ˆë‹¤
            </p>
        </header>

        <!-- ë©”ì¸ ì…ë ¥ ì˜ì—­ -->
        <div class="main-grid">
            <!-- ë²•ë¬¸ ì…ë ¥ íŒ¨ë„ -->
            <div class="panel">
                <h2>ğŸ“œ ë²•ë¬¸ ì…ë ¥</h2>
                
                <!-- íŒŒì¼ ì—…ë¡œë“œ ì˜ì—­ -->
                <div class="upload-area" id="uploadArea">
                    <div style="font-size: 3em; margin-bottom: 15px;">ğŸ“„</div>
                    <h3>ë²•ë¬¸ íŒŒì¼ì„ ì—¬ê¸°ì— ë“œë˜ê·¸í•˜ì„¸ìš”</h3>
                    <p style="margin: 10px 0; opacity: 0.7;">ë˜ëŠ” í´ë¦­í•˜ì—¬ íŒŒì¼ ì„ íƒ</p>
                    <p style="font-size: 0.9em; opacity: 0.6;">ì§€ì› í˜•ì‹: PDF, TXT, DOC, DOCX</p>
                    <div style="margin-top: 15px; font-size: 0.8em; color: #666;">
                        âœ¨ ë“œë˜ê·¸ ì•¤ ë“œë¡­ìœ¼ë¡œ ê°„í¸í•˜ê²Œ ì—…ë¡œë“œí•˜ì„¸ìš”!
                    </div>
                    <input type="file" id="fileInput" style="display: none;" accept=".pdf,.txt,.doc,.docx">
                </div>

                <!-- í…ìŠ¤íŠ¸ ì§ì ‘ ì…ë ¥ -->
                <div style="text-align: center; margin: 20px 0;">
                    <strong>ë˜ëŠ”</strong>
                </div>
                
                <textarea class="dharma-input" id="dharmaText" placeholder="ë²•ë¬¸ ë‚´ìš©ì„ ì§ì ‘ ë¶™ì—¬ë„£ì–´ì£¼ì„¸ìš”...

ğŸ“ ì˜ˆì‹œ 1 - íŒ”ì •ë„ ë²•ë¬¸:
ë¶€ì²˜ë‹˜ê»˜ì„œ ë§ì”€í•˜ì‹  íŒ”ì •ë„ëŠ” ê¹¨ë‹¬ìŒì— ì´ë¥´ëŠ” ì—¬ëŸ ê°€ì§€ ë°”ë¥¸ ê¸¸ì…ë‹ˆë‹¤.
ì •ê²¬(æ­£è¦‹): ì˜¬ë°”ë¥¸ ê²¬í•´ë¥¼ ê°–ëŠ” ê²ƒ
ì •ì‚¬ìœ (æ­£æ€æƒŸ): ì˜¬ë°”ë¥¸ ìƒê°ì„ í•˜ëŠ” ê²ƒ  
ì •ì–´(æ­£èª): ì˜¬ë°”ë¥¸ ë§ì„ í•˜ëŠ” ê²ƒ
ì •ì—…(æ­£æ¥­): ì˜¬ë°”ë¥¸ í–‰ë™ì„ í•˜ëŠ” ê²ƒ
ì •ëª…(æ­£å‘½): ì˜¬ë°”ë¥¸ ìƒí™œì„ í•˜ëŠ” ê²ƒ
ì •ì •ì§„(æ­£ç²¾é€²): ì˜¬ë°”ë¥¸ ë…¸ë ¥ì„ í•˜ëŠ” ê²ƒ
ì •ë…(æ­£å¿µ): ì˜¬ë°”ë¥¸ ë§ˆìŒì±™ê¹€ì„ í•˜ëŠ” ê²ƒ
ì •ì •(æ­£å®š): ì˜¬ë°”ë¥¸ ì§‘ì¤‘ì„ í•˜ëŠ” ê²ƒ

ğŸ“ ì˜ˆì‹œ 2 - ì‚¬ì„±ì œ ë²•ë¬¸:
ì‚¬ì„±ì œëŠ” ë¶€ì²˜ë‹˜ì´ ê¹¨ë‹¬ìœ¼ì‹  ë„¤ ê°€ì§€ ì„±ìŠ¤ëŸ¬ìš´ ì§„ë¦¬ì…ë‹ˆë‹¤.
ê³ ì„±ì œ: ê´´ë¡œì›€ì´ ìˆë‹¤ëŠ” ì§„ë¦¬
ì§‘ì„±ì œ: ê´´ë¡œì›€ì˜ ì›ì¸ì´ ìˆë‹¤ëŠ” ì§„ë¦¬  
ë©¸ì„±ì œ: ê´´ë¡œì›€ì´ ì‚¬ë¼ì§ˆ ìˆ˜ ìˆë‹¤ëŠ” ì§„ë¦¬
ë„ì„±ì œ: ê´´ë¡œì›€ì„ ì—†ì• ëŠ” ë°©ë²•ì´ ìˆë‹¤ëŠ” ì§„ë¦¬

ğŸ¯ ìœ„ ì˜ˆì‹œ ì¤‘ í•˜ë‚˜ë¥¼ ë³µì‚¬í•´ì„œ í…ŒìŠ¤íŠ¸í•´ë³´ì„¸ìš”!"></textarea>
            </div>

            <!-- ì„¤ì • íŒ¨ë„ -->
            <div class="panel">
                <h2>ğŸ¨ ê²Œì„ ì„¤ì •</h2>
                
                <h3 style="margin: 20px 0 10px 0;">ê²Œì„ ìŠ¤íƒ€ì¼</h3>
                <div class="options-grid">
                    <div class="option-card selected" data-style="modern">
                        <div style="font-size: 2em;">ğŸŒŸ</div>
                        <div>í˜„ëŒ€ì </div>
                    </div>
                    <div class="option-card" data-style="traditional">
                        <div style="font-size: 2em;">ğŸ®</div>
                        <div>ì „í†µì </div>
                    </div>
                    <div class="option-card" data-style="minimal">
                        <div style="font-size: 2em;">âšª</div>
                        <div>ë¯¸ë‹ˆë©€</div>
                    </div>
                </div>

                <h3 style="margin: 20px 0 10px 0;">ìƒ‰ìƒ í…Œë§ˆ</h3>
                <div class="options-grid">
                    <div class="option-card selected" data-color="blue">
                        <div style="background: linear-gradient(135deg, #667eea, #764ba2); width: 30px; height: 30px; border-radius: 50%; margin: 0 auto 5px;"></div>
                        <div>íŒŒë€ìƒ‰</div>
                    </div>
                    <div class="option-card" data-color="green">
                        <div style="background: linear-gradient(135deg, #56ab2f, #a8e6cf); width: 30px; height: 30px; border-radius: 50%; margin: 0 auto 5px;"></div>
                        <div>ì´ˆë¡ìƒ‰</div>
                    </div>
                    <div class="option-card" data-color="purple">
                        <div style="background: linear-gradient(135deg, #8360c3, #2ebf91); width: 30px; height: 30px; border-radius: 50%; margin: 0 auto 5px;"></div>
                        <div>ë³´ë¼ìƒ‰</div>
                    </div>
                    <div class="option-card" data-color="orange">
                        <div style="background: linear-gradient(135deg, #f093fb, #f5576c); width: 30px; height: 30px; border-radius: 50%; margin: 0 auto 5px;"></div>
                        <div>ì£¼í™©ìƒ‰</div>
                    </div>
                </div>

                <h3 style="margin: 20px 0 10px 0;">ì• ë‹ˆë©”ì´ì…˜</h3>
                <div class="options-grid">
                    <div class="option-card selected" data-animation="smooth">
                        <div style="font-size: 2em;">âœ¨</div>
                        <div>ë¶€ë“œëŸ¬ì›€</div>
                    </div>
                    <div class="option-card" data-animation="dynamic">
                        <div style="font-size: 2em;">ğŸ¬</div>
                        <div>ì—­ë™ì </div>
                    </div>
                    <div class="option-card" data-animation="minimal">
                        <div style="font-size: 2em;">â–</div>
                        <div>ìµœì†Œí•œ</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ê²Œì„ ìƒì„± ë²„íŠ¼ -->
        <div style="text-align: center;">
            <button class="btn btn-large" id="generateBtn">
                ğŸš€ ë§ˆìŒì±™ê¹€ ê²Œì„ ìë™ ìƒì„±í•˜ê¸°
            </button>
        </div>

        <!-- ì§„í–‰ìƒí™© -->
        <div class="progress-container" id="progressContainer">
            <h2>ğŸ”„ ê²Œì„ ìƒì„± ì¤‘...</h2>
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            <div id="progressText">ë²•ë¬¸ ë¶„ì„ ì¤‘...</div>
        </div>

        <!-- ê²°ê³¼ ì˜ì—­ -->
        <div class="result-container" id="resultContainer">
            <h2>ğŸ‰ ê²Œì„ ìƒì„± ì™„ë£Œ!</h2>
            
            <div id="analysisResult"></div>
            
            <div class="download-buttons">
                <button class="btn" id="previewBtn">ğŸ‘€ ë¯¸ë¦¬ë³´ê¸°</button>
                <button class="btn" id="downloadBtn">ğŸ’¾ HTML ë‹¤ìš´ë¡œë“œ</button>
                <button class="btn" id="downloadPdfBtn">ğŸ“„ ì•„í‚¤í…ì²˜ PDF ë‹¤ìš´ë¡œë“œ</button>
                <button class="btn" id="copyCodeBtn">ğŸ“‹ ì½”ë“œ ë³µì‚¬</button>
                <button class="btn" id="newGameBtn">ğŸ”„ ìƒˆ ê²Œì„ ë§Œë“¤ê¸°</button>
            </div>

            <div id="previewArea" style="display: none;">
                <h3>ğŸ“± ê²Œì„ ë¯¸ë¦¬ë³´ê¸°</h3>
                <iframe class="preview-frame" id="previewFrame"></iframe>
            </div>

            <div id="codeArea" style="display: none;">
                <h3>ğŸ’» ìƒì„±ëœ HTML ì½”ë“œ</h3>
                <div class="code-output" id="codeOutput"></div>
            </div>
        </div>

        <!-- ì‚¬ìš© íŒ -->
        <div class="tips">
            <h3>ğŸ’¡ ì‚¬ìš© íŒ</h3>
            <ul style="margin: 10px 0; padding-left: 20px;">
                <li>íŒ”ì •ë„, ì‚¬ì„±ì œ, ì‚¼í•™, ì‚¬ë…ì²˜ ë“± êµ¬ì¡°ê°€ ëª…í™•í•œ ë²•ë¬¸ì¼ìˆ˜ë¡ ë” ì¢‹ì€ ê²Œì„ì´ ìƒì„±ë©ë‹ˆë‹¤</li>
                <li>ë²•ë¬¸ í…ìŠ¤íŠ¸ê°€ ê¸¸ê³  ìì„¸í• ìˆ˜ë¡ ë” í’ë¶€í•œ ì½˜í…ì¸ ê°€ ìƒì„±ë©ë‹ˆë‹¤</li>
                <li>ìƒì„±ëœ HTML íŒŒì¼ì€ GitHub Pagesì— ë°”ë¡œ ì—…ë¡œë“œí•˜ì—¬ ì„œë¹„ìŠ¤í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤</li>
                <li>ëª¨ë°”ì¼ì—ì„œë„ ì™„ë²½í•˜ê²Œ ì‘ë™í•˜ëŠ” ë°˜ì‘í˜• ê²Œì„ì´ ìƒì„±ë©ë‹ˆë‹¤</li>
            </ul>
        </div>
    </div>

    <!-- ì•Œë¦¼ -->
    <div class="notification" id="notification"></div>

    <script>
        // ì „ì—­ ë³€ìˆ˜
        let selectedOptions = {
            style: 'modern',
            color: 'blue',
            animation: 'smooth'
        };

        let generatedHTML = '';
        let analysisData = {};

        // DOM ìš”ì†Œë“¤
        const uploadArea = document.getElementById('uploadArea');
        const fileInput = document.getElementById('fileInput');
        const dharmaText = document.getElementById('dharmaText');
        const generateBtn = document.getElementById('generateBtn');
        const progressContainer = document.getElementById('progressContainer');
        const resultContainer = document.getElementById('resultContainer');

        // ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', function() {
            setupEventListeners();
            setupFileUpload();
            setupOptionCards();
            
            // ì „ì—­ ë“œë˜ê·¸ ì•¤ ë“œë¡­ ì´ë²¤íŠ¸ ë°©ì§€ (íŒŒì¼ì´ ë¸Œë¼ìš°ì €ì—ì„œ ì—´ë¦¬ëŠ” ê²ƒ ë°©ì§€)
            ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
                document.addEventListener(eventName, function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                }, false);
            });
            
            // ì´ˆê¸° ì•Œë¦¼
            setTimeout(() => {
                showNotification('ğŸ‰ ë²•ë¬¸ ê²Œì„ ìƒì„±ê¸°ê°€ ì¤€ë¹„ë˜ì—ˆìŠµë‹ˆë‹¤! íŒŒì¼ì„ ë“œë˜ê·¸í•˜ê±°ë‚˜ í…ìŠ¤íŠ¸ë¥¼ ì…ë ¥í•´ë³´ì„¸ìš”.', 'info');
            }, 1000);
        });

        // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„¤ì •
        function setupEventListeners() {
            generateBtn.addEventListener('click', generateGame);
            document.getElementById('previewBtn').addEventListener('click', showPreview);
            document.getElementById('downloadBtn').addEventListener('click', downloadHTML);
            document.getElementById('downloadPdfBtn').addEventListener('click', downloadPDF);
            document.getElementById('copyCodeBtn').addEventListener('click', copyCode);
            document.getElementById('newGameBtn').addEventListener('click', resetForm);
        }

        // íŒŒì¼ ì—…ë¡œë“œ ì„¤ì •
        function setupFileUpload() {
            uploadArea.addEventListener('click', () => fileInput.click());
            uploadArea.addEventListener('dragover', handleDragOver);
            uploadArea.addEventListener('drop', handleDrop);
            uploadArea.addEventListener('dragleave', handleDragLeave);
            fileInput.addEventListener('change', handleFileSelect);
        }

        function handleDragOver(e) {
            e.preventDefault();
            e.stopPropagation();
            uploadArea.classList.add('dragover');
            e.dataTransfer.dropEffect = 'copy';
        }

        function handleDragLeave(e) {
            e.preventDefault();
            e.stopPropagation();
            // ì‹¤ì œë¡œ ì˜ì—­ì„ ë²—ì–´ë‚¬ëŠ”ì§€ í™•ì¸
            if (!uploadArea.contains(e.relatedTarget)) {
                uploadArea.classList.remove('dragover');
            }
        }

        function handleDrop(e) {
            e.preventDefault();
            e.stopPropagation();
            uploadArea.classList.remove('dragover');
            
            const files = e.dataTransfer.files;
            console.log('ë“œë¡­ëœ íŒŒì¼:', files.length, 'ê°œ');
            
            if (files.length > 0) {
                const file = files[0];
                console.log('íŒŒì¼ ì •ë³´:', {
                    name: file.name,
                    size: file.size,
                    type: file.type
                });
                
                // íŒŒì¼ í˜•ì‹ ê²€ì¦
                const allowedTypes = [
                    'text/plain',
                    'application/pdf', 
                    'application/msword',
                    'application/vnd.openxmlformats-officedocument.wordprocessingml.document'
                ];
                
                const allowedExtensions = ['.txt', '.pdf', '.doc', '.docx'];
                const fileExtension = file.name.toLowerCase().substring(file.name.lastIndexOf('.'));
                
                if (allowedTypes.includes(file.type) || allowedExtensions.includes(fileExtension) || file.type === '') {
                    showNotification(`"${file.name}" íŒŒì¼ ì²˜ë¦¬ë¥¼ ì‹œì‘í•©ë‹ˆë‹¤...`, 'info');
                    processFile(file);
                } else {
                    showNotification(`ì§€ì›í•˜ì§€ ì•ŠëŠ” íŒŒì¼ í˜•ì‹ì…ë‹ˆë‹¤. (${file.type})\\nì§€ì› í˜•ì‹: TXT, PDF, DOC, DOCX`, 'error');
                }
            } else {
                showNotification('íŒŒì¼ì´ ê°ì§€ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.', 'error');
            }
        }

        function handleFileSelect(e) {
            const file = e.target.files[0];
            if (file) {
                console.log('ì„ íƒëœ íŒŒì¼:', file.name);
                processFile(file);
            }
        }

        async function processFile(file) {
            try {
                showNotification('íŒŒì¼ì„ ì½ëŠ” ì¤‘ì…ë‹ˆë‹¤...', 'info');
                let text = '';
                
                // Claude Artifact í™˜ê²½ì—ì„œ íŒŒì¼ ì½ê¸°
                if (window.fs && window.fs.readFile) {
                    try {
                        // Claude Artifactì˜ fs API ì‚¬ìš©
                        const uint8Array = await window.fs.readFile(file.name);
                        const decoder = new TextDecoder('utf-8');
                        text = decoder.decode(uint8Array);
                    } catch (fsError) {
                        console.log('fs API ì‹¤íŒ¨, FileReaderë¡œ ëŒ€ì²´:', fsError);
                        // fs API ì‹¤íŒ¨ ì‹œ ì¼ë°˜ FileReader ì‚¬ìš©
                        text = await readFileAsText(file);
                    }
                } else {
                    // ì¼ë°˜ ë¸Œë¼ìš°ì € í™˜ê²½ì—ì„œ FileReader ì‚¬ìš©
                    text = await readFileAsText(file);
                }
                
                if (text && text.trim().length > 0) {
                    dharmaText.value = text;
                    showNotification(`íŒŒì¼ "${file.name}"ì„ ì„±ê³µì ìœ¼ë¡œ ë¶ˆëŸ¬ì™”ìŠµë‹ˆë‹¤! (${text.length}ì)`, 'success');
                    
                    // íŒŒì¼ ë‚´ìš© ë¯¸ë¦¬ë³´ê¸°
                    const preview = text.length > 200 ? text.substring(0, 200) + '...' : text;
                    console.log('íŒŒì¼ ë‚´ìš© ë¯¸ë¦¬ë³´ê¸°:', preview);
                } else {
                    showNotification('íŒŒì¼ì´ ë¹„ì–´ìˆê±°ë‚˜ ì½ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.', 'error');
                }
            } catch (error) {
                console.error('íŒŒì¼ ì½ê¸° ì˜¤ë¥˜:', error);
                showNotification(`íŒŒì¼ì„ ì½ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ${error.message}`, 'error');
            }
        }

        function readFileAsText(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.onload = (e) => {
                    try {
                        resolve(e.target.result);
                    } catch (error) {
                        reject(error);
                    }
                };
                reader.onerror = () => reject(new Error('íŒŒì¼ ì½ê¸° ì‹¤íŒ¨'));
                reader.readAsText(file, 'UTF-8');
            });
        }

        // ì˜µì…˜ ì¹´ë“œ ì„¤ì •
        function setupOptionCards() {
            document.querySelectorAll('.option-card').forEach(card => {
                card.addEventListener('click', function() {
                    const parent = this.parentElement;
                    parent.querySelectorAll('.option-card').forEach(c => c.classList.remove('selected'));
                    this.classList.add('selected');
                    
                    // ì„ íƒëœ ì˜µì…˜ ì €ì¥
                    if (this.dataset.style) selectedOptions.style = this.dataset.style;
                    if (this.dataset.color) selectedOptions.color = this.dataset.color;
                    if (this.dataset.animation) selectedOptions.animation = this.dataset.animation;
                });
            });
        }

        // ê²Œì„ ìƒì„± ë©”ì¸ í•¨ìˆ˜
        async function generateGame() {
            const text = dharmaText.value.trim();
            if (!text) {
                showNotification('ë²•ë¬¸ ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”!', 'error');
                return;
            }

            showProgress();
            
            try {
                // 1ë‹¨ê³„: ë²•ë¬¸ ë¶„ì„
                updateProgress(20, 'ë²•ë¬¸ ë‚´ìš© ë¶„ì„ ì¤‘...');
                analysisData = analyzeDharmaText(text);
                
                await delay(1000);
                
                // 2ë‹¨ê³„: ê²Œì„ êµ¬ì¡° ì„¤ê³„
                updateProgress(40, 'ê²Œì„ êµ¬ì¡° ì„¤ê³„ ì¤‘...');
                const gameStructure = designGameStructure(analysisData);
                
                await delay(1000);
                
                // 3ë‹¨ê³„: ì½˜í…ì¸  ìƒì„±
                updateProgress(60, 'ê²Œì„ ì½˜í…ì¸  ìƒì„± ì¤‘...');
                const gameContent = generateGameContent(analysisData, gameStructure);
                
                await delay(1000);
                
                // 4ë‹¨ê³„: HTML ì½”ë“œ ìƒì„±
                updateProgress(80, 'HTML ì½”ë“œ ìƒì„± ì¤‘...');
                generatedHTML = generateHTMLCode(gameContent, selectedOptions);
                
                await delay(1000);
                
                // 5ë‹¨ê³„: ì™„ë£Œ
                updateProgress(100, 'ê²Œì„ ìƒì„± ì™„ë£Œ!');
                
                await delay(500);
                
                showResult();
                
            } catch (error) {
                showNotification('ê²Œì„ ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
                hideProgress();
            }
        }

        // ë²•ë¬¸ í…ìŠ¤íŠ¸ ë¶„ì„
        function analyzeDharmaText(text) {
            const analysis = {
                detectedTopics: [],
                structure: null,
                elements: [],
                keyPhrases: [],
                practiceElements: []
            };

            // ì£¼ìš” ë¶ˆêµ ì£¼ì œ ê°ì§€
            const topics = [
                { key: 'íŒ”ì •ë„', pattern: /(íŒ”ì •ë„|ì •ê²¬|ì •ì‚¬ìœ |ì •ì–´|ì •ì—…|ì •ëª…|ì •ì •ì§„|ì •ë…|ì •ì •)/g, steps: 8 },
                { key: 'ì‚¬ì„±ì œ', pattern: /(ì‚¬ì„±ì œ|ê³ ì„±ì œ|ì§‘ì„±ì œ|ë©¸ì„±ì œ|ë„ì„±ì œ|ê³ ì§‘ë©¸ë„)/g, steps: 4 },
                { key: 'ì‚¼í•™', pattern: /(ì‚¼í•™|ê³„ì •í˜œ|ê³„ìœ¨|ì„ ì •|ì§€í˜œ)/g, steps: 3 },
                { key: 'ì‚¬ë…ì²˜', pattern: /(ì‚¬ë…ì²˜|ì‹ ë…ì²˜|ìˆ˜ë…ì²˜|ì‹¬ë…ì²˜|ë²•ë…ì²˜)/g, steps: 4 },
                { key: 'ì˜¤ì˜¨', pattern: /(ì˜¤ì˜¨|ìƒ‰ìˆ˜ìƒí–‰ì‹|ìƒ‰ì˜¨|ìˆ˜ì˜¨|ìƒì˜¨|í–‰ì˜¨|ì‹ì˜¨)/g, steps: 5 },
                { key: 'ì‹­ì´ì—°ê¸°', pattern: /(ì‹­ì´ì—°ê¸°|ì—°ê¸°ë²•|ë¬´ëª…|í–‰|ì‹|ëª…ìƒ‰|ìœ¡ì…|ì´‰|ìˆ˜|ì• |ì·¨|ìœ |ìƒ|ë…¸ì‚¬)/g, steps: 12 },
                { key: 'ì‚¬ë¬´ëŸ‰ì‹¬', pattern: /(ì‚¬ë¬´ëŸ‰ì‹¬|ìë¹„í¬ì‚¬|ìì• |ì—°ë¯¼|ê¸°ì¨|í‰ì •)/g, steps: 4 }
            ];

            topics.forEach(topic => {
                const matches = text.match(topic.pattern);
                if (matches && matches.length > 2) {
                    analysis.detectedTopics.push(topic.key);
                    if (!analysis.structure) {
                        analysis.structure = { name: topic.key, steps: topic.steps };
                    }
                }
            });

            // ìˆ˜í–‰ ìš”ì†Œ ì¶”ì¶œ
            const practicePatterns = [
                { name: 'ëª…ìƒ', pattern: /(ëª…ìƒ|ì¢Œì„ |ì„ ì •|ì‚¬ë§ˆíƒ€|ìœ„ë¹ ì‚¬ë‚˜)/g },
                { name: 'ê´€ì°°', pattern: /(ê´€ì°°|ì•Œì•„ì°¨ë¦¼|ë§ˆìŒì±™ê¹€|ì‚¬ë )/g },
                { name: 'í˜¸í¡', pattern: /(í˜¸í¡|ë“¤ìˆ¨|ë‚ ìˆ¨|ìˆ¨|ì•„ë‚˜ë¹ ë‚˜)/g },
                { name: 'ê±·ê¸°', pattern: /(ê±·ê¸°|í–‰ì„ |ë³´í–‰)/g },
                { name: 'ìë¹„', pattern: /(ìë¹„|ìì• |ì—°ë¯¼|ë©”ë”°)/g }
            ];

            practicePatterns.forEach(pattern => {
                if (text.match(pattern.pattern)) {
                    analysis.practiceElements.push(pattern.name);
                }
            });

            // í•µì‹¬ ë¬¸êµ¬ ì¶”ì¶œ (ê°„ë‹¨í•œ ë°©ì‹)
            const sentences = text.split(/[.!?ã€‚]/);
            analysis.keyPhrases = sentences
                .filter(s => s.length > 10 && s.length < 100)
                .slice(0, 10)
                .map(s => s.trim());

            // ê¸°ë³¸ êµ¬ì¡° ì„¤ì •
            if (!analysis.structure) {
                analysis.structure = { name: 'ë§ˆìŒì±™ê¹€ ìˆ˜í–‰', steps: 6 };
            }

            return analysis;
        }

        // ê²Œì„ êµ¬ì¡° ì„¤ê³„
        function designGameStructure(analysis) {
            const structure = {
                type: analysis.structure.name,
                steps: analysis.structure.steps,
                elements: [],
                quests: [],
                achievements: []
            };

            // ë‹¨ê³„ë³„ ìš”ì†Œ ìƒì„±
            for (let i = 1; i <= structure.steps; i++) {
                structure.elements.push({
                    id: `step${i}`,
                    name: `${structure.type} ${i}ë‹¨ê³„`,
                    description: `${structure.type}ì˜ ${i}ë²ˆì§¸ ë‹¨ê³„ë¥¼ ì‹¤ì²œí•´ë³´ì„¸ìš”`,
                    icon: getStepIcon(i)
                });
            }

            // í€˜ìŠ¤íŠ¸ ìƒì„±
            structure.quests = [
                { name: `${structure.steps}ë‹¨ê³„ ëª¨ë‘ ê´€ì°°í•˜ê¸°`, reward: 100 },
                { name: '10ë¶„ ëª…ìƒ ì™„ë£Œí•˜ê¸°', reward: 50 },
                { name: 'í•˜ë£¨ ì—°ì† ìˆ˜í–‰í•˜ê¸°', reward: 75 },
                { name: 'ì§€í˜œ ë¬¸êµ¬ 10ê°œ ì½ê¸°', reward: 30 }
            ];

            // ì„±ì·¨ ì‹œìŠ¤í…œ
            structure.achievements = [
                { name: 'ìˆ˜í–‰ ì‹œì‘', condition: 'ì²« ë²ˆì§¸ ë‹¨ê³„ ì™„ë£Œ', reward: 25 },
                { name: `${structure.type} ì´í•´`, condition: 'ì ˆë°˜ ë‹¨ê³„ ì™„ë£Œ', reward: 50 },
                { name: 'ì™„ì „í•œ ì´í•´', condition: 'ëª¨ë“  ë‹¨ê³„ ì™„ë£Œ', reward: 100 }
            ];

            return structure;
        }

        // ê²Œì„ ì½˜í…ì¸  ìƒì„±
        function generateGameContent(analysis, structure) {
            return {
                title: `${structure.type} ìˆ˜í–‰ ê²Œì„`,
                description: `${structure.type}ì˜ ê°€ë¥´ì¹¨ì„ í†µí•´ ë§ˆìŒì±™ê¹€ì„ ì‹¤ì²œí•˜ëŠ” ì¸í„°ë™í‹°ë¸Œ ê²Œì„`,
                elements: structure.elements,
                quests: structure.quests,
                achievements: structure.achievements,
                wisdomTexts: analysis.keyPhrases,
                practiceElements: analysis.practiceElements,
                scienceConnections: generateScienceConnections(structure.type)
            };
        }

        // ê³¼í•™ì  ì—°ê´€ì„± ìƒì„±
        function generateScienceConnections(topic) {
            const connections = {
                'íŒ”ì •ë„': [
                    { field: 'ë‡Œê³¼í•™', content: 'ì˜¬ë°”ë¥¸ ë§ˆìŒì±™ê¹€ì´ ì „ì „ë‘í”¼ì§ˆì„ í™œì„±í™”ì‹œì¼œ ê°ì • ì¡°ì ˆ ëŠ¥ë ¥ì„ í–¥ìƒì‹œí‚µë‹ˆë‹¤.' },
                    { field: 'ì‹¬ë¦¬í•™', content: 'ì •ê²¬ê³¼ ì •ì‚¬ìœ ëŠ” ì¸ì§€ í–‰ë™ ì¹˜ë£Œì˜ í•µì‹¬ ì›ë¦¬ì™€ ì¼ì¹˜í•©ë‹ˆë‹¤.' }
                ],
                'ì‚¬ì„±ì œ': [
                    { field: 'ì‹¬ë¦¬í•™', content: 'ê³ í†µì˜ ì›ì¸ê³¼ í•´ê²°ì±…ì„ ì°¾ëŠ” ê³¼ì •ì€ í˜„ëŒ€ ì‹¬ë¦¬ì¹˜ë£Œì˜ ê¸°ë³¸ ì ‘ê·¼ë²•ì…ë‹ˆë‹¤.' },
                    { field: 'ë‡Œê³¼í•™', content: 'ì§‘ì°©ì„ ë†“ì•„ì£¼ëŠ” ì—°ìŠµì´ ê¸°ë³¸ ëª¨ë“œ ë„¤íŠ¸ì›Œí¬ì˜ í™œë™ì„ ì¡°ì ˆí•©ë‹ˆë‹¤.' }
                ],
                'ì‚¼í•™': [
                    { field: 'ë‡Œê³¼í•™', content: 'ê³„ìœ¨, ì„ ì •, ì§€í˜œì˜ ìˆœì°¨ì  ë°œì „ì´ ë‡Œì˜ ë‹¨ê³„ì  ë°œë‹¬ê³¼ ì¼ì¹˜í•©ë‹ˆë‹¤.' },
                    { field: 'ìƒë¦¬í•™', content: 'ëª…ìƒ ìˆ˜í–‰ì´ ìŠ¤íŠ¸ë ˆìŠ¤ í˜¸ë¥´ëª¬ì„ ê°ì†Œì‹œí‚¤ê³  ë©´ì—­ ê¸°ëŠ¥ì„ í–¥ìƒì‹œí‚µë‹ˆë‹¤.' }
                ]
            };

            return connections[topic] || [
                { field: 'ë‡Œê³¼í•™', content: 'ë§ˆìŒì±™ê¹€ ìˆ˜í–‰ì´ ë‡Œì˜ ì‹ ê²½ê°€ì†Œì„±ì„ ì¦ì§„ì‹œí‚µë‹ˆë‹¤.' },
                { field: 'ì‹¬ë¦¬í•™', content: 'ê·œì¹™ì ì¸ ìˆ˜í–‰ì´ ì •ì‹  ê±´ê°•ê³¼ ì›°ë¹™ì„ í–¥ìƒì‹œí‚µë‹ˆë‹¤.' }
            ];
        }

        // HTML ì½”ë“œ ìƒì„±
        function generateHTMLCode(content, options) {
            const colorThemes = {
                blue: { primary: '#667eea', secondary: '#764ba2' },
                green: { primary: '#56ab2f', secondary: '#a8e6cf' },
                purple: { primary: '#8360c3', secondary: '#2ebf91' },
                orange: { primary: '#f093fb', secondary: '#f5576c' }
            };

            const theme = colorThemes[options.color];
            
            return `<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>${content.title}</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(-45deg, ${theme.primary}, ${theme.secondary}, ${theme.primary}, ${theme.secondary});
            background-size: 400% 400%;
            animation: gradientShift 15s ease infinite;
            min-height: 100vh;
            color: white;
            overflow-x: hidden;
        }

        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            padding: 30px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(15px);
            border-radius: 20px;
            margin-bottom: 30px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
        }

        .game-title {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .player-stats {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .stat-item {
            background: rgba(255, 255, 255, 0.2);
            padding: 15px 25px;
            border-radius: 15px;
            text-align: center;
            min-width: 120px;
        }

        .stat-value {
            font-size: 1.8em;
            font-weight: bold;
            color: #ffeb3b;
        }

        .game-board {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .game-card {
            background: rgba(255, 255, 255, 0.15);
            border-radius: 20px;
            padding: 25px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .game-card:hover {
            transform: translateY(-10px) scale(1.02);
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.3);
        }

        .card-title {
            font-size: 1.5em;
            margin-bottom: 15px;
            color: #ffeb3b;
            text-align: center;
        }

        .elements-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin: 20px 0;
        }

        .element-item {
            background: rgba(255, 255, 255, 0.2);
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .element-item:hover {
            background: rgba(255, 255, 255, 0.3);
            border-color: #ffeb3b;
            transform: scale(1.05);
        }

        .element-item.completed {
            background: rgba(255, 235, 59, 0.3);
            border-color: #ffeb3b;
        }

        .progress-circle {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            background: conic-gradient(#4caf50 0deg, #4caf50 var(--progress, 0deg), transparent var(--progress, 0deg));
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 20px auto;
            position: relative;
        }

        .progress-circle::before {
            content: '';
            width: 80px;
            height: 80px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            position: absolute;
        }

        .progress-text {
            position: relative;
            z-index: 1;
            font-weight: bold;
        }

        .btn {
            background: linear-gradient(135deg, ${theme.primary}, ${theme.secondary});
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            cursor: pointer;
            margin: 10px;
            font-size: 1.1em;
            font-weight: bold;
            transition: all 0.3s ease;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.3);
        }

        .timer-display {
            font-size: 3em;
            font-weight: bold;
            margin: 20px 0;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
            color: #ffeb3b;
            text-align: center;
        }

        .wisdom-text {
            font-style: italic;
            text-align: center;
            padding: 20px;
            background: rgba(0,0,0,0.2);
            border-radius: 10px;
            margin: 15px 0;
            line-height: 1.6;
        }

        .science-content {
            background: rgba(0,0,0,0.2);
            padding: 20px;
            border-radius: 10px;
            margin: 15px 0;
        }

        .achievement-popup {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0);
            background: linear-gradient(135deg, #4caf50, #45a049);
            padding: 30px;
            border-radius: 20px;
            text-align: center;
            z-index: 1000;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
        }

        .achievement-popup.show {
            animation: achievementPop 2s ease-out forwards;
        }

        @keyframes achievementPop {
            0% { transform: translate(-50%, -50%) scale(0); }
            20% { transform: translate(-50%, -50%) scale(1.2); }
            40% { transform: translate(-50%, -50%) scale(1); }
            100% { transform: translate(-50%, -50%) scale(1); }
        }

        @media (max-width: 768px) {
            .game-title { font-size: 2em; }
            .timer-display { font-size: 2em; }
            .player-stats { flex-direction: column; align-items: center; }
            .elements-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="header">
            <h1 class="game-title">${content.title}</h1>
            <p>${content.description}</p>
            
            <div class="player-stats">
                <div class="stat-item">
                    <div class="stat-value" id="level">1</div>
                    <div>ìˆ˜í–‰ ë ˆë²¨</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="experience">0</div>
                    <div>ê²½í—˜ì¹˜</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="wisdom">0</div>
                    <div>ì§€í˜œ í¬ì¸íŠ¸</div>
                </div>
            </div>
        </header>

        <div class="game-board">
            <div class="game-card">
                <h3 class="card-title">ğŸ¯ ${content.elements.length}ë‹¨ê³„ ìˆ˜í–‰</h3>
                <div class="elements-grid" id="elementsGrid">
                    ${content.elements.map((element, index) => `
                        <div class="element-item" onclick="completeElement(${index})" data-index="${index}">
                            <div style="font-size: 1.2em; margin-bottom: 5px;">${element.icon} ${element.name}</div>
                            <div style="font-size: 0.9em; opacity: 0.8;">${element.description}</div>
                        </div>
                    `).join('')}
                </div>
                <div class="progress-circle" style="--progress: 0deg;">
                    <div class="progress-text" id="progressText">0%</div>
                </div>
            </div>

            <div class="game-card">
                <h3 class="card-title">â° ëª…ìƒ íƒ€ì´ë¨¸</h3>
                <div class="timer-display" id="timer">00:00</div>
                <div style="text-align: center;">
                    <button class="btn" onclick="setTimer(5)">5ë¶„</button>
                    <button class="btn" onclick="setTimer(10)">10ë¶„</button>
                    <button class="btn" onclick="setTimer(20)">20ë¶„</button>
                </div>
                <div style="text-align: center; margin-top: 15px;">
                    <button class="btn" onclick="startTimer()" id="startBtn">ì‹œì‘</button>
                    <button class="btn" onclick="resetTimer()">ë¦¬ì…‹</button>
                </div>
            </div>

            <div class="game-card">
                <h3 class="card-title">ğŸ’ ìˆ˜í–‰ ì§€í˜œ</h3>
                <div class="wisdom-text" id="wisdomText">
                    ${content.wisdomTexts[0] || 'ë§ˆìŒì±™ê¹€ì€ í˜„ì¬ ìˆœê°„ì— ê¹¨ì–´ìˆëŠ” ê²ƒì…ë‹ˆë‹¤.'}
                </div>
                <button class="btn" onclick="showWisdom()">ìƒˆë¡œìš´ ì§€í˜œ</button>
            </div>

            <div class="game-card">
                <h3 class="card-title">ğŸ§¬ ê³¼í•™ì  ê·¼ê±°</h3>
                <div class="science-content" id="scienceContent">
                    <h4 style="color: #ffeb3b; margin-bottom: 10px;">${content.scienceConnections[0]?.field || 'ë‡Œê³¼í•™'}</h4>
                    <p>${content.scienceConnections[0]?.content || 'ëª…ìƒì€ ë‡Œì˜ êµ¬ì¡°ë¥¼ ê¸ì •ì ìœ¼ë¡œ ë³€í™”ì‹œí‚µë‹ˆë‹¤.'}</p>
                </div>
                <button class="btn" onclick="showScience()">ê³¼í•™ ì„¤ëª…</button>
            </div>
        </div>
    </div>

    <div class="achievement-popup" id="achievementPopup">
        <h2>ğŸ‰ ì„±ì·¨ ë‹¬ì„±!</h2>
        <p id="achievementText"></p>
    </div>

    <script>
        let gameState = {
            level: 1,
            experience: 0,
            wisdom: 0,
            completedElements: new Set(),
            currentTimer: 0,
            timerInterval: null,
            isTimerRunning: false
        };

        const wisdomTexts = ${JSON.stringify(content.wisdomTexts)};
        const scienceConnections = ${JSON.stringify(content.scienceConnections)};
        const totalElements = ${content.elements.length};

        function completeElement(index) {
            if (gameState.completedElements.has(index)) return;
            
            gameState.completedElements.add(index);
            gameState.experience += 20;
            gameState.wisdom += 10;
            
            const element = document.querySelector('[data-index="' + index + '"]');
            element.classList.add('completed');
            
            updateProgress();
            updateStats();
            
            if (gameState.completedElements.size === totalElements) {
                showAchievement('ğŸ† ëª¨ë“  ë‹¨ê³„ ì™„ë£Œ!', 'ì™„ì „í•œ ì´í•´ì— ë„ë‹¬í–ˆìŠµë‹ˆë‹¤!');
                gameState.experience += 100;
                updateStats();
            }
            
            checkLevelUp();
        }

        function updateProgress() {
            const progress = (gameState.completedElements.size / totalElements) * 100;
            const degrees = (progress / 100) * 360;
            
            document.querySelector('.progress-circle').style.setProperty('--progress', degrees + 'deg');
            document.getElementById('progressText').textContent = Math.round(progress) + '%';
        }

        function updateStats() {
            document.getElementById('level').textContent = gameState.level;
            document.getElementById('experience').textContent = gameState.experience;
            document.getElementById('wisdom').textContent = gameState.wisdom;
        }

        function checkLevelUp() {
            const requiredExp = gameState.level * 100;
            if (gameState.experience >= requiredExp) {
                gameState.level++;
                gameState.experience -= requiredExp;
                showAchievement('ë ˆë²¨ ì—…!', 'ë ˆë²¨ ' + gameState.level + 'ì— ë„ë‹¬í–ˆìŠµë‹ˆë‹¤!');
                updateStats();
            }
        }

        function showAchievement(title, description) {
            const popup = document.getElementById('achievementPopup');
            document.getElementById('achievementText').innerHTML = '<strong>' + title + '</strong><br>' + description;
            popup.classList.add('show');
            setTimeout(() => popup.classList.remove('show'), 3000);
        }

        function setTimer(minutes) {
            gameState.currentTimer = minutes * 60;
            updateTimerDisplay();
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(gameState.currentTimer / 60);
            const seconds = gameState.currentTimer % 60;
            document.getElementById('timer').textContent = 
                minutes.toString().padStart(2, '0') + ':' + seconds.toString().padStart(2, '0');
        }

        function startTimer() {
            if (gameState.currentTimer <= 0) return;
            
            if (!gameState.isTimerRunning) {
                gameState.isTimerRunning = true;
                document.getElementById('startBtn').textContent = 'ì¼ì‹œì •ì§€';
                
                gameState.timerInterval = setInterval(() => {
                    gameState.currentTimer--;
                    updateTimerDisplay();
                    
                    if (gameState.currentTimer <= 0) {
                        resetTimer();
                        showAchievement('ëª…ìƒ ì™„ë£Œ!', 'ëª…ìƒì„ ì„±ê³µì ìœ¼ë¡œ ì™„ë£Œí–ˆìŠµë‹ˆë‹¤!');
                        gameState.experience += 50;
                        gameState.wisdom += 25;
                        updateStats();
                        checkLevelUp();
                    }
                }, 1000);
            } else {
                pauseTimer();
            }
        }

        function pauseTimer() {
            gameState.isTimerRunning = false;
            clearInterval(gameState.timerInterval);
            document.getElementById('startBtn').textContent = 'ì‹œì‘';
        }

        function resetTimer() {
            pauseTimer();
            gameState.currentTimer = 0;
            updateTimerDisplay();
        }

        function showWisdom() {
            const randomWisdom = wisdomTexts[Math.floor(Math.random() * wisdomTexts.length)];
            document.getElementById('wisdomText').textContent = randomWisdom;
            gameState.wisdom += 5;
            updateStats();
        }

        function showScience() {
            const randomScience = scienceConnections[Math.floor(Math.random() * scienceConnections.length)];
            document.getElementById('scienceContent').innerHTML = 
                '<h4 style="color: #ffeb3b; margin-bottom: 10px;">' + randomScience.field + '</h4>' +
                '<p>' + randomScience.content + '</p>';
        }

        // ìë™ ì½˜í…ì¸  ìˆœí™˜
        setInterval(showWisdom, 30000);
        setInterval(showScience, 45000);
    </script>
</body>
</html>`;
        }

        // ë‹¨ê³„ë³„ ì•„ì´ì½˜ ìƒì„±
        function getStepIcon(step) {
            const icons = ['ğŸŒ±', 'ğŸŒ¿', 'ğŸŒ³', 'ğŸŒ¸', 'ğŸƒ', 'ğŸŒº', 'ğŸŒ»', 'ğŸŒ¹', 'ğŸŒ·', 'ğŸŒ¼', 'ğŸŒµ', 'ğŸ‹'];
            return icons[step - 1] || 'ğŸ”¹';
        }

        // UI ì—…ë°ì´íŠ¸ í•¨ìˆ˜ë“¤
        function showProgress() {
            progressContainer.style.display = 'block';
            resultContainer.style.display = 'none';
            generateBtn.disabled = true;
            generateBtn.innerHTML = '<div class="loading-spinner"></div>ìƒì„± ì¤‘...';
        }

        function updateProgress(percent, text) {
            document.getElementById('progressFill').style.width = percent + '%';
            document.getElementById('progressText').textContent = text;
        }

        function hideProgress() {
            progressContainer.style.display = 'none';
            generateBtn.disabled = false;
            generateBtn.innerHTML = 'ğŸš€ ë§ˆìŒì±™ê¹€ ê²Œì„ ìë™ ìƒì„±í•˜ê¸°';
        }

        function showResult() {
            hideProgress();
            resultContainer.style.display = 'block';
            
            // ë¶„ì„ ê²°ê³¼ í‘œì‹œ
            const analysisHTML = `
                <div class="analysis-result">
                    <h3>ğŸ“Š ë²•ë¬¸ ë¶„ì„ ê²°ê³¼</h3>
                    <p><strong>ê°ì§€ëœ ì£¼ì œ:</strong> ${analysisData.structure.name}</p>
                    <p><strong>ê²Œì„ êµ¬ì¡°:</strong> ${analysisData.structure.steps}ë‹¨ê³„ ìˆ˜í–‰ ì‹œìŠ¤í…œ</p>
                    <div class="detected-elements">
                        ${analysisData.detectedTopics.map(topic => `<span class="element-tag">${topic}</span>`).join('')}
                        ${analysisData.practiceElements.map(element => `<span class="element-tag">${element}</span>`).join('')}
                    </div>
                    <p style="margin-top: 15px;"><strong>ìƒì„±ëœ ì½˜í…ì¸ :</strong> ${analysisData.keyPhrases.length}ê°œ ì§€í˜œ ë¬¸êµ¬, ${analysisData.practiceElements.length}ê°œ ìˆ˜í–‰ ìš”ì†Œ</p>
                </div>

                <!-- ë²•ë¬¸ ì•„í‚¤í…ì²˜ ì‹œê°í™” -->
                <div class="architecture-diagram" id="architectureDiagram">
                    <!-- PDF ì „ìš© í—¤ë” -->
                    <div class="pdf-only pdf-title">ğŸ“¿ ${analysisData.structure.name} ìˆ˜í–‰ ì•„í‚¤í…ì²˜</div>
                    <div class="pdf-only pdf-date">ìƒì„±ì¼: ${new Date().toLocaleDateString('ko-KR', { 
                        year: 'numeric', 
                        month: 'long', 
                        day: 'numeric',
                        weekday: 'long'
                    })}</div>
                    
                    <h3 style="text-align: center; color: #667eea; margin-bottom: 20px;">ğŸ—ï¸ ë²•ë¬¸ ìˆ˜í–‰ ì•„í‚¤í…ì²˜</h3>
                    
                    <!-- êµ¬ì¡° íŠ¸ë¦¬ -->
                    <div class="structure-tree">
                        <div class="tree-node root">ğŸ“¿ ${analysisData.structure.name}</div>
                        <div class="tree-connector"></div>
                        
                        <div class="tree-level">
                            ${generateStructureNodes(analysisData)}
                        </div>
                    </div>

                    <!-- ìˆ˜í–‰ í”Œë¡œìš° ë‹¤ì´ì–´ê·¸ë¨ -->
                    <h4 style="text-align: center; color: #667eea; margin: 30px 0 20px;">ğŸ”„ ìˆ˜í–‰ í”Œë¡œìš°</h4>
                    <div class="flow-diagram">
                        ${generateFlowSteps(analysisData)}
                    </div>

                    <!-- ìˆ˜í–‰ ìš”ì†Œë“¤ -->
                    <h4 style="text-align: center; color: #667eea; margin: 30px 0 20px;">ğŸ§˜ ìˆ˜í–‰ ìš”ì†Œ</h4>
                    <div class="practice-elements">
                        ${analysisData.practiceElements.map(element => `
                            <div class="practice-card">
                                <div style="font-size: 2em; margin-bottom: 10px;">${getPracticeIcon(element)}</div>
                                <h5>${element}</h5>
                                <p style="font-size: 0.9em; margin-top: 5px;">${getPracticeDescription(element)}</p>
                            </div>
                        `).join('')}
                    </div>

                    <!-- í‚¤ì›Œë“œ í´ë¼ìš°ë“œ -->
                    <h4 style="text-align: center; color: #667eea; margin: 30px 0 20px;">ğŸ·ï¸ í•µì‹¬ í‚¤ì›Œë“œ</h4>
                    <div class="keyword-cloud">
                        ${generateKeywordTags(analysisData)}
                    </div>

                    <!-- ê³¼í•™ì  ì—°ê´€ì„± -->
                    <h4 style="text-align: center; color: #667eea; margin: 30px 0 20px;">ğŸ§¬ ê³¼í•™ì  ì—°ê´€ì„±</h4>
                    <div class="science-connections">
                        ${generateScienceCards(analysisData)}
                    </div>

                    <!-- ìˆ˜í–‰ íƒ€ì„ë¼ì¸ -->
                    <h4 style="text-align: center; color: #667eea; margin: 30px 0 20px;">â° ìˆ˜í–‰ íƒ€ì„ë¼ì¸</h4>
                    <div class="timeline">
                        ${generateTimeline(analysisData)}
                    </div>
                </div>
            `;
            
            document.getElementById('analysisResult').innerHTML = analysisHTML;
        }

        // êµ¬ì¡° ë…¸ë“œ ìƒì„±
        function generateStructureNodes(analysis) {
            const nodes = [];
            for (let i = 1; i <= analysis.structure.steps; i++) {
                nodes.push(`
                    <div class="tree-node" onclick="highlightStep(${i})">
                        ${getStepIcon(i)} ${i}ë‹¨ê³„
                        <div style="font-size: 0.8em; margin-top: 5px; opacity: 0.9;">
                            ${getStepName(analysis.structure.name, i)}
                        </div>
                    </div>
                `);
            }
            return nodes.join('');
        }

        // í”Œë¡œìš° ë‹¨ê³„ ìƒì„±
        function generateFlowSteps(analysis) {
            const flowSteps = getFlowSteps(analysis.structure.name);
            return flowSteps.map(step => `
                <div class="flow-step">
                    <div style="font-size: 1.5em; margin-bottom: 10px;">${step.icon}</div>
                    <h5>${step.title}</h5>
                    <p style="font-size: 0.9em; margin-top: 5px;">${step.description}</p>
                </div>
            `).join('');
        }

        // í‚¤ì›Œë“œ íƒœê·¸ ìƒì„±
        function generateKeywordTags(analysis) {
            const keywords = [
                ...analysis.detectedTopics,
                ...analysis.practiceElements,
                'ë§ˆìŒì±™ê¹€', 'ì§€í˜œ', 'í•´íƒˆ', 'ê¹¨ë‹¬ìŒ', 'ìˆ˜í–‰'
            ];
            return [...new Set(keywords)].map(keyword => 
                `<span class="keyword-tag" onclick="explainKeyword('${keyword}')">${keyword}</span>`
            ).join('');
        }

        // ê³¼í•™ ì¹´ë“œ ìƒì„±
        function generateScienceCards(analysis) {
            const scienceConnections = generateScienceConnections(analysis.structure.name);
            return scienceConnections.map(connection => `
                <div class="science-card">
                    <h5 style="color: #e17055; margin-bottom: 10px;">ğŸ”¬ ${connection.field}</h5>
                    <p>${connection.content}</p>
                </div>
            `).join('');
        }

        // íƒ€ì„ë¼ì¸ ìƒì„±
        function generateTimeline(analysis) {
            const timelineItems = [
                { title: 'ìˆ˜í–‰ ì‹œì‘', description: 'ë²•ë¬¸ ì´í•´ì™€ ë™ê¸° í™•ë¦½', icon: 'ğŸŒ±' },
                { title: 'ê¸°ì´ˆ ì‹¤ì²œ', description: 'ê¸°ë³¸ ìˆ˜í–‰ë²• ìµíˆê¸°', icon: 'ğŸ“š' },
                { title: 'ê¹Šì€ ì´í•´', description: 'ì²´í—˜ì„ í†µí•œ ê¹¨ë‹¬ìŒ', icon: 'ğŸ’¡' },
                { title: 'ì™„ì „í•œ ì²´ë“', description: 'ì¼ìƒ ì† ìì—°ìŠ¤ëŸ¬ìš´ ì‹¤ì²œ', icon: 'ğŸŒŸ' },
                { title: 'ì§€í˜œ ì™„ì„±', description: 'í•´íƒˆê³¼ ê¹¨ë‹¬ìŒ ì„±ì·¨', icon: 'ğŸ†' }
            ];

            return timelineItems.map((item, index) => `
                <div class="timeline-item">
                    <div class="timeline-content">
                        <div style="font-size: 2em; margin-bottom: 10px;">${item.icon}</div>
                        <h5>${item.title}</h5>
                        <p style="margin-top: 10px;">${item.description}</p>
                    </div>
                    <div class="timeline-marker"></div>
                </div>
            `).join('');
        }

        // ë‹¨ê³„ë³„ ì´ë¦„ ìƒì„±
        function getStepName(structureName, step) {
            const stepNames = {
                'íŒ”ì •ë„': ['ì •ê²¬', 'ì •ì‚¬ìœ ', 'ì •ì–´', 'ì •ì—…', 'ì •ëª…', 'ì •ì •ì§„', 'ì •ë…', 'ì •ì •'],
                'ì‚¬ì„±ì œ': ['ê³ ì„±ì œ', 'ì§‘ì„±ì œ', 'ë©¸ì„±ì œ', 'ë„ì„±ì œ'],
                'ì‚¼í•™': ['ê³„í•™', 'ì •í•™', 'í˜œí•™'],
                'ì‚¬ë…ì²˜': ['ì‹ ë…ì²˜', 'ìˆ˜ë…ì²˜', 'ì‹¬ë…ì²˜', 'ë²•ë…ì²˜'],
                'ì˜¤ì˜¨': ['ìƒ‰ì˜¨', 'ìˆ˜ì˜¨', 'ìƒì˜¨', 'í–‰ì˜¨', 'ì‹ì˜¨'],
                'ì‹­ì´ì—°ê¸°': ['ë¬´ëª…', 'í–‰', 'ì‹', 'ëª…ìƒ‰', 'ìœ¡ì…', 'ì´‰', 'ìˆ˜', 'ì• ', 'ì·¨', 'ìœ ', 'ìƒ', 'ë…¸ì‚¬']
            };
            
            const names = stepNames[structureName] || [`${step}ë‹¨ê³„`];
            return names[step - 1] || `${step}ë‹¨ê³„`;
        }

        // í”Œë¡œìš° ë‹¨ê³„ ì •ì˜
        function getFlowSteps(structureName) {
            const flowSteps = {
                'íŒ”ì •ë„': [
                    { icon: 'ğŸ‘ï¸', title: 'ì˜¬ë°”ë¥¸ ê²¬í•´', description: 'ì‚¬ì„±ì œë¥¼ ì´í•´í•˜ê¸°' },
                    { icon: 'ğŸ’­', title: 'ì˜¬ë°”ë¥¸ ì‚¬ìœ ', description: 'ë°”ë¥¸ ë§ˆìŒê°€ì§' },
                    { icon: 'ğŸ—£ï¸', title: 'ì˜¬ë°”ë¥¸ ë§', description: 'ì§„ì‹¤í•œ ì–¸ì–´' },
                    { icon: 'ğŸ¤²', title: 'ì˜¬ë°”ë¥¸ í–‰ë™', description: 'ìœ¤ë¦¬ì  ì‹¤ì²œ' }
                ],
                'ì‚¬ì„±ì œ': [
                    { icon: 'ğŸ˜”', title: 'ê³ ì„±ì œ', description: 'ê´´ë¡œì›€ì˜ ì§„ë¦¬' },
                    { icon: 'ğŸ”—', title: 'ì§‘ì„±ì œ', description: 'ì›ì¸ì˜ ì§„ë¦¬' },
                    { icon: 'ğŸ•Šï¸', title: 'ë©¸ì„±ì œ', description: 'ì†Œë©¸ì˜ ì§„ë¦¬' },
                    { icon: 'ğŸ›¤ï¸', title: 'ë„ì„±ì œ', description: 'ë°©ë²•ì˜ ì§„ë¦¬' }
                ],
                'ì‚¼í•™': [
                    { icon: 'âš–ï¸', title: 'ê³„í•™', description: 'ìœ¤ë¦¬ì  í–‰ë™' },
                    { icon: 'ğŸ§˜', title: 'ì •í•™', description: 'ë§ˆìŒ ì§‘ì¤‘' },
                    { icon: 'ğŸ’¡', title: 'í˜œí•™', description: 'ì§€í˜œ ê³„ë°œ' }
                ]
            };
            
            return flowSteps[structureName] || [
                { icon: 'ğŸŒ±', title: 'ì‹œì‘', description: 'ìˆ˜í–‰ ì‹œì‘í•˜ê¸°' },
                { icon: 'ğŸŒ¿', title: 'ë°œì „', description: 'ì ì§„ì  ì„±ì¥' },
                { icon: 'ğŸŒ¸', title: 'ì™„ì„±', description: 'ëª©í‘œ ë‹¬ì„±' }
            ];
        }

        // ìˆ˜í–‰ ì•„ì´ì½˜ ë°˜í™˜
        function getPracticeIcon(element) {
            const icons = {
                'ëª…ìƒ': 'ğŸ§˜',
                'ê´€ì°°': 'ğŸ‘ï¸',
                'í˜¸í¡': 'ğŸ«',
                'ê±·ê¸°': 'ğŸš¶',
                'ìë¹„': 'ğŸ’',
                'ì§€í˜œ': 'ğŸ’¡',
                'ì§‘ì¤‘': 'ğŸ¯'
            };
            return icons[element] || 'ğŸ”¸';
        }

        // ìˆ˜í–‰ ì„¤ëª… ë°˜í™˜
        function getPracticeDescription(element) {
            const descriptions = {
                'ëª…ìƒ': 'ê³ ìš”í•œ ë§ˆìŒìœ¼ë¡œ ë‚´ë©´ì„ ê´€ì°°í•˜ëŠ” ìˆ˜í–‰',
                'ê´€ì°°': 'í˜„ì¬ ìˆœê°„ì— ê¹¨ì–´ìˆëŠ” ë§ˆìŒì±™ê¹€',
                'í˜¸í¡': 'ë“¤ìˆ¨ê³¼ ë‚ ìˆ¨ì„ í†µí•œ ì§‘ì¤‘ ìˆ˜í–‰',
                'ê±·ê¸°': 'ë³´í–‰ì„ í†µí•œ ë™ì  ëª…ìƒ',
                'ìë¹„': 'ìì‹ ê³¼ íƒ€ì¸ì— ëŒ€í•œ ì‚¬ë‘ê³¼ ì—°ë¯¼',
                'ì§€í˜œ': 'ì‚¬ë¬¼ì˜ ë³¸ì§ˆì„ ê¿°ëš«ì–´ ë³´ëŠ” í†µì°°',
                'ì§‘ì¤‘': 'í•œ ì ì— ë§ˆìŒì„ ëª¨ìœ¼ëŠ” ì„ ì •'
            };
            return descriptions[element] || 'ë§ˆìŒì„ ì •í™”í•˜ëŠ” ìˆ˜í–‰ë²•';
        }

        // ì¸í„°ë™í‹°ë¸Œ ê¸°ëŠ¥ë“¤
        function highlightStep(step) {
            showNotification(`${step}ë‹¨ê³„: ${getStepName(analysisData.structure.name, step)} ë‹¨ê³„ë¥¼ ì„ íƒí–ˆìŠµë‹ˆë‹¤!`);
        }

        function explainKeyword(keyword) {
            const explanations = {
                'íŒ”ì •ë„': 'ë¶€ì²˜ë‹˜ì´ ê°€ë¥´ì¹˜ì‹  ê¹¨ë‹¬ìŒì— ì´ë¥´ëŠ” ì—¬ëŸ ê°€ì§€ ë°”ë¥¸ ê¸¸',
                'ì‚¬ì„±ì œ': 'ê´´ë¡œì›€ê³¼ ê·¸ ì›ì¸, ì†Œë©¸ê³¼ ë°©ë²•ì— ëŒ€í•œ ë„¤ ê°€ì§€ ì„±ìŠ¤ëŸ¬ìš´ ì§„ë¦¬',
                'ì‚¼í•™': 'ê³„ìœ¨, ì„ ì •, ì§€í˜œë¡œ ì´ë£¨ì–´ì§„ ì„¸ ê°€ì§€ í•™ìŠµ',
                'ë§ˆìŒì±™ê¹€': 'í˜„ì¬ ìˆœê°„ì— ê¹¨ì–´ìˆëŠ” ì˜ì‹ì  ì£¼ì˜',
                'ì§€í˜œ': 'ì‚¬ë¬¼ì˜ ì°¸ëœ ë³¸ì„±ì„ ê¿°ëš«ì–´ ë³´ëŠ” ëŠ¥ë ¥',
                'í•´íƒˆ': 'ëª¨ë“  ê´´ë¡œì›€ì—ì„œ ì™„ì „íˆ ë²—ì–´ë‚œ ììœ ë¡œìš´ ìƒíƒœ'
            };
            
            const explanation = explanations[keyword] || `${keyword}ì— ëŒ€í•œ ê¹Šì€ ì´í•´ê°€ í•„ìš”í•œ ì¤‘ìš”í•œ ê°œë…ì…ë‹ˆë‹¤.`;
            showNotification(`ğŸ’¡ ${keyword}: ${explanation}`);
        }

        function showPreview() {
            const previewArea = document.getElementById('previewArea');
            const previewFrame = document.getElementById('previewFrame');
            
            if (previewArea.style.display === 'none') {
                previewArea.style.display = 'block';
                previewFrame.srcdoc = generatedHTML;
                document.getElementById('previewBtn').textContent = 'ğŸ™ˆ ë¯¸ë¦¬ë³´ê¸° ìˆ¨ê¸°ê¸°';
            } else {
                previewArea.style.display = 'none';
                document.getElementById('previewBtn').textContent = 'ğŸ‘€ ë¯¸ë¦¬ë³´ê¸°';
            }
        }

        function downloadHTML() {
            const blob = new Blob([generatedHTML], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `${analysisData.structure.name}_ê²Œì„.html`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            showNotification('HTML íŒŒì¼ì´ ë‹¤ìš´ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤!');
        }

        function downloadPDF() {
            if (!analysisData.structure) {
                showNotification('ë¨¼ì € ê²Œì„ì„ ìƒì„±í•´ì£¼ì„¸ìš”!', 'error');
                return;
            }

            // PDF ì œëª© í‘œì‹œ
            const pdfElements = document.querySelectorAll('.pdf-only');
            pdfElements.forEach(el => el.style.display = 'block');
            
            // í˜„ì¬ ì œëª© ë³€ê²½
            const originalTitle = document.title;
            document.title = `${analysisData.structure.name}_ì•„í‚¤í…ì²˜_${new Date().toLocaleDateString('ko-KR').replace(/\./g, '_')}`;
            
            // ì¸ì‡„ ë‹¤ì´ì–¼ë¡œê·¸ ì—´ê¸°
            setTimeout(() => {
                window.print();
                
                // ì›ë˜ ìƒíƒœë¡œ ë³µì›
                setTimeout(() => {
                    pdfElements.forEach(el => el.style.display = 'none');
                    document.title = originalTitle;
                }, 1000);
            }, 500);
            
            showNotification('ğŸ“„ PDF ì €ì¥ ë‹¤ì´ì–¼ë¡œê·¸ê°€ ì—´ë ¸ìŠµë‹ˆë‹¤. "PDFë¡œ ì €ì¥"ì„ ì„ íƒí•˜ì„¸ìš”!');
        }

        function copyCode() {
            const codeArea = document.getElementById('codeArea');
            const codeOutput = document.getElementById('codeOutput');
            
            if (codeArea.style.display === 'none') {
                codeArea.style.display = 'block';
                codeOutput.textContent = generatedHTML;
                document.getElementById('copyCodeBtn').textContent = 'ğŸ“‹ ì½”ë“œ ìˆ¨ê¸°ê¸°';
            } else {
                navigator.clipboard.writeText(generatedHTML).then(() => {
                    showNotification('ì½”ë“œê°€ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!');
                });
            }
        }

        function resetForm() {
            dharmaText.value = '';
            hideProgress();
            resultContainer.style.display = 'none';
            document.getElementById('previewArea').style.display = 'none';
            document.getElementById('codeArea').style.display = 'none';
            document.getElementById('previewBtn').textContent = 'ğŸ‘€ ë¯¸ë¦¬ë³´ê¸°';
            document.getElementById('copyCodeBtn').textContent = 'ğŸ“‹ ì½”ë“œ ë³µì‚¬';
            
            showNotification('ìƒˆë¡œìš´ ê²Œì„ì„ ë§Œë“¤ ì¤€ë¹„ê°€ ë˜ì—ˆìŠµë‹ˆë‹¤!');
        }

        function showNotification(message, type = 'success') {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.className = 'notification show';
            
            // ì•Œë¦¼ íƒ€ì…ë³„ ìƒ‰ìƒ ì„¤ì •
            if (type === 'error') {
                notification.style.background = 'linear-gradient(135deg, #e74c3c, #c0392b)';
            } else if (type === 'info') {
                notification.style.background = 'linear-gradient(135deg, #3498db, #2980b9)';
            } else {
                notification.style.background = 'linear-gradient(135deg, #4caf50, #45a049)';
            }
            
            // ì½˜ì†”ì—ë„ ë¡œê·¸ ì¶œë ¥
            console.log(`[${type.toUpperCase()}] ${message}`);
            
            // 3ì´ˆ í›„ ìë™ ìˆ¨ê¹€
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }

        function delay(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }
    </script>
</body>
</html>
